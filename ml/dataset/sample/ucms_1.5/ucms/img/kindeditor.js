/*******************************************************************************
* KindEditor - WYSIWYG HTML Editor for Internet
* Copyright (C) 2006-2013 kindsoft.net
*
* @author Roddy <luolonghao@gmail.com>
* @website http://www.kindsoft.net/
* @licence http://www.kindsoft.net/license.php
* @version 4.1.10 (2013-11-23)
*******************************************************************************/(function(A,Bc){function ca(a){return a?"[object Array]"===Object.prototype.toString.call(a):!1}function Aa(a){return a?"[object Function]"===Object.prototype.toString.call(a):!1}function N(a,b){for(var c=0,d=b.length;c<d;c++)if(a===b[c])return c;return-1}function n(a,b){if(ca(a))for(var c=0,d=a.length;c<d&&!1!==b.call(a[c],c,a[c]);c++);else for(c in a)if(a.hasOwnProperty(c)&&!1===b.call(a[c],c,a[c]))break}function D(a){return a.replace(/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"")}function Ba(a,b,c){c=
void 0===c?",":c;return 0<=(c+b+c).indexOf(c+a+c)}function t(a,b){b=b||"px";return a&&/^\d+$/.test(a)?a+b:a}function w(a){var b;return a&&(b=/(\d+)/.exec(a))?parseInt(b[1],10):0}function E(a){return a.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;")}function ja(a){return a.replace(/&lt;/g,"\x3c").replace(/&gt;/g,"\x3e").replace(/&quot;/g,'"').replace(/&amp;/g,"\x26")}function ka(a){var b=a.split("-");a="";n(b,function(b,d){a+=0<b?d.charAt(0).toUpperCase()+
d.substr(1):d});return a}function Ca(a){function b(a){a=parseInt(a,10).toString(16).toUpperCase();return 1<a.length?a:"0"+a}return a.replace(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/ig,function(a,d,e,g){return"#"+b(d)+b(e)+b(g)})}function v(a,b){b=void 0===b?",":b;var c={},d=ca(a)?a:a.split(b),e;n(d,function(a,b){if(e=/^(\d+)\.\.(\d+)$/.exec(b))for(var d=parseInt(e[1],10);d<=parseInt(e[2],10);d++)c[d.toString()]=!0;else c[b]=!0});return c}function Na(a,b){return Array.prototype.slice.call(a,
b||0)}function l(a,b){return void 0===a?b:a}function Yb(a){return!a||/[<>"]/.test(a)}function Zb(a,b){return 0<=a.indexOf("?")?a+"\x26"+b:a+"?"+b}function I(a,b,c){c||(c=b,b=null);var d;if(b){var e=function(){};e.prototype=b.prototype;d=new e;n(c,function(a,b){d[a]=b})}else d=c;d.constructor=a;a.prototype=d;a.parent=b?b.prototype:null}function ib(a){var b;if(b=/\{[\s\S]*\}|\[[\s\S]*\]/.exec(a))a=b[0];b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
b.lastIndex=0;b.test(a)&&(a=a.replace(b,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return eval("("+a+")");throw"JSON parse error";}function $b(){for(var a=document.getElementsByTagName("script"),b,c=0,d=a.length;c<d;c++)if(b=a[c].src||"",/kindeditor[\w\-\.]*\.js/.test(b))return b.substring(0,
b.lastIndexOf("/")+1);return""}function ac(a,b,c){a.addEventListener?a.addEventListener(b,c,jb):a.attachEvent&&a.attachEvent("on"+b,c)}function Da(a,b,c){a.removeEventListener?a.removeEventListener(b,c,jb):a.detachEvent&&a.detachEvent("on"+b,c)}function kb(a,b){this.init(a,b)}function lb(a){try{delete a[da]}catch(b){a.removeAttribute&&a.removeAttribute(da)}}function ea(a,b,c){if(0<=b.indexOf(","))n(b.split(","),function(){ea(a,this,c)});else{var d=a[da]||null;d||(a[da]=++mb,d=mb);void 0===z[d]&&(z[d]=
{});var e=z[d][b];e&&0<e.length?Da(a,b,e[0]):(z[d][b]=[],z[d].el=a);e=z[d][b];0===e.length&&(e[0]=function(b){var c=b?new kb(a,b):void 0;n(e,function(b,d){0<b&&d&&d.call(a,c)})});0>N(c,e)&&e.push(c);ac(a,b,e[0])}}function la(a,b,c){if(b&&0<=b.indexOf(","))n(b.split(","),function(){la(a,this,c)});else{var d=a[da]||null;if(d)if(void 0===b)d in z&&(n(z[d],function(b,c){"el"!=b&&0<c.length&&Da(a,b,c[0])}),delete z[d],lb(a));else if(z[d]){var e=z[d][b];if(e&&0<e.length){void 0===c?(Da(a,b,e[0]),delete z[d][b]):
(n(e,function(a,b){0<a&&b===c&&e.splice(a,1)}),1==e.length&&(Da(a,b,e[0]),delete z[d][b]));var g=0;n(z[d],function(){g++});2>g&&(delete z[d],lb(a))}}}}function nb(a,b){if(0<=b.indexOf(","))n(b.split(","),function(){nb(a,this)});else{var c=a[da]||null;if(c){var d=z[c][b];if(z[c]&&d&&0<d.length)d[0]()}}}function Oa(a,b,c){b=/^\d{2,}$/.test(b)?b:b.toUpperCase().charCodeAt(0);ea(a,"keydown",function(d){!d.ctrlKey||d.which!=b||d.shiftKey||d.altKey||(c.call(a),d.stop())})}function bc(a){function b(){e||
(e=!0,a(KindEditor),ob=!0)}function c(){if(!e){try{document.documentElement.doScroll("left")}catch(a){setTimeout(c,100);return}b()}}function d(){"complete"===document.readyState&&b()}if(ob)a(KindEditor);else{var e=!1;if(document.addEventListener)ea(document,"DOMContentLoaded",b);else if(document.attachEvent){ea(document,"readystatechange",d);var g=!1;try{g=null==A.frameElement}catch(h){}document.documentElement.doScroll&&g&&c()}ea(A,"load",b)}}function fa(a){a=a.replace(/&quot;/g, ' ');for(var b={},c=/\s*([\w\-]+)\s*:([^;]*)(;|$)/g,
d;d=c.exec(a);){var e=D(d[1].toLowerCase());d=D(Ca(d[2]));b[e]=d}return b}function M(a){for(var b={},c=/\s+(?:([\w\-:]+)|(?:([\w\-:]+)=([^\s"'<>]+))|(?:([\w\-:"]+)="([^"]*)")|(?:([\w\-:"]+)='([^']*)'))(?=(?:\s|\/|>)+)/g,d;d=c.exec(a);){var e=(d[1]||d[2]||d[4]||d[6]).toLowerCase();b[e]=(d[2]?d[3]:d[4]?d[5]:d[7])||""}return b}function cc(a,b){return a=/\s+class\s*=/.test(a)?a.replace(/(\s+class=["']?)([^"']*)(["']?[\s>])/,function(a,d,e,g){return 0>(" "+e+" ").indexOf(" "+b+" ")?""===e?d+b+g:d+e+" "+
b+g:a}):a.substr(0,a.length-1)+' class\x3d"'+b+'"\x3e'}function dc(a){var b="";n(fa(a),function(a,d){b+=a+":"+d+";"});return b}function ma(a,b,c,d){function e(a){a=a.split("/");for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];".."==e?0<b.length&&b.pop():""!==e&&"."!=e&&b.push(e)}return"/"+b.join("/")}function g(b,c){if(a.substr(0,b.length)===b){for(var e=[],h=0;h<c;h++)e.push("..");h=".";0<e.length&&(h+="/"+e.join("/"));"/"==d&&(h+="/");return h+a.substr(b.length)}if(f=/^(.*)\//.exec(b))return g(f[1],
++c)}b=l(b,"").toLowerCase();"data:"!=a.substr(0,5)&&(a=a.replace(/([^:])\/\//g,"$1/"));if(0>N(b,["absolute","relative","domain"]))return a;c=c||location.protocol+"//"+location.host;if(void 0===d){var h=location.pathname.match(/^(\/.*)\//);d=h?h[1]:""}var f;if(f=/^(\w+:\/\/[^\/]*)/.exec(a)){if(f[1]!==c)return a}else if(/^\w+:/.test(a))return a;/^\//.test(a)?a=c+e(a.substr(1)):/^\w+:\/\//.test(a)||(a=c+e(d+"/"+a));"relative"===b?a=g(c+d,0).substr(2):"absolute"===b&&a.substr(0,c.length)===c&&(a=a.substr(c.length));
return a}function X(a,b,c,d,e){null==a&&(a="");c=c||"";d=l(d,!1);e=l(e,"\t");var g="xx-small x-small small medium large x-large xx-large".split(" ");a=a.replace(/(<(?:pre|pre\s[^>]*)>)([\s\S]*?)(<\/pre>)/ig,function(a,b,c,d){return b+c.replace(/<(?:br|br\s[^>]*)>/ig,"\n")+d});a=a.replace(/<(?:br|br\s[^>]*)\s*\/?>\s*<\/p>/ig,"\x3c/p\x3e");a=a.replace(/(<(?:p|p\s[^>]*)>)\s*(<\/p>)/ig,"$1\x3cbr /\x3e$2");a=a.replace(/\u200B/g,"");a=a.replace(/\u00A9/g,"\x26copy;");a=a.replace(/\u00AE/g,"\x26reg;");a=
a.replace(/\u2003/g,"\x26emsp;");a=a.replace(/\u3000/g,"\x26emsp;");a=a.replace(/<[^>]+/g,function(a){return a.replace(/\s+/g," ")});var h={};b&&(n(b,function(a,b){for(var c=a.split(","),d=0,e=c.length;d<e;d++)h[c[d]]=v(b)}),h.script||(a=a.replace(/(<(?:script|script\s[^>]*)>)([\s\S]*?)(<\/script>)/ig,"")),h.style||(a=a.replace(/(<(?:style|style\s[^>]*)>)([\s\S]*?)(<\/style>)/ig,"")));var f=[];a=a.replace(/(\s*)<(\/)?([\w\-:]+)((?:\s+|(?:\s+[\w\-:]+)|(?:\s+[\w\-:]+=[^\s"'<>]+)|(?:\s+[\w\-:"]+="[^"]*")|(?:\s+[\w\-:"]+='[^']*'))*)(\/)?>(\s*)/g,
function(a,p,s,r,G,na,l){p=p||"";s=s||"";var u=r.toLowerCase(),q=G||"";r=na?" "+na:"";l=l||"";if(b&&!h[u])return"";""===r&&pb[u]&&(r=" /");qb[u]&&(p&&(p=" "),l&&(l=" "));Pa[u]&&(s?l="\n":p="\n");d&&"br"==u&&(l="\n");if(rb[u]&&!Pa[u])if(d){s&&0<f.length&&f[f.length-1]===u?f.pop():f.push(u);l=p="\n";G=0;for(na=s?f.length:f.length-1;G<na;G++)p+=e,s||(l+=e);r?f.pop():s||(l+=e)}else p=l="";if(""!==q){var B=M(a);if("font"===u){var O={},H="";n(B,function(a,b){"color"===a&&(O.color=b,delete B[a]);"size"===
a&&(O["font-size"]=g[parseInt(b,10)-1]||"",delete B[a]);"face"===a&&(O["font-family"]=b,delete B[a]);"style"===a&&(H=b)});H&&!/;$/.test(H)&&(H+=";");n(O,function(a,b){""!==b&&(/\s/.test(b)&&(b="'"+b+"'"),H+=a+":"+b+";")});B.style=H}n(B,function(a,d){ec[a]&&(B[a]=a);0<=N(a,["src","href"])&&(B[a]=ma(d,c));(b&&"style"!==a&&!h[u]["*"]&&!h[u][a]||"body"===u&&"contenteditable"===a||/^kindeditor_\d+$/.test(a))&&delete B[a];if("style"===a&&""!==d){var e=fa(d);n(e,function(a,c){!b||h[u].style||h[u]["."+a]||
delete e[a]});var g="";n(e,function(a,b){g+=a+":"+b+";"});B.style=g}});q="";n(B,function(a,b){if("style"!==a||""!==b)b=b.replace(/"/g,"\x26quot;"),q+=" "+a+'\x3d"'+b+'"'})}"font"===u&&(u="span");return p+"\x3c"+s+u+q+r+"\x3e"+l});a=a.replace(/(<(?:pre|pre\s[^>]*)>)([\s\S]*?)(<\/pre>)/ig,function(a,b,c,d){return b+c.replace(/\n/g,'\x3cspan id\x3d"__kindeditor_pre_newline__"\x3e\n')+d});a=a.replace(/\n\s*\n/g,"\n");a=a.replace(/<span id="__kindeditor_pre_newline__">\n/g,"\n");return D(a)}function sb(a,
b){a=a.replace(/<meta[\s\S]*?>/ig,"").replace(/<![\s\S]*?>/ig,"").replace(/<style[^>]*>[\s\S]*?<\/style>/ig,"").replace(/<script[^>]*>[\s\S]*?<\/script>/ig,"").replace(/<w:[^>]+>[\s\S]*?<\/w:[^>]+>/ig,"").replace(/<o:[^>]+>[\s\S]*?<\/o:[^>]+>/ig,"").replace(/<xml>[\s\S]*?<\/xml>/ig,"").replace(/<(?:table|td)[^>]*>/ig,function(a){return a.replace(/border-bottom:([#\w\s]+)/ig,"border:$1")});return X(a,b)}function tb(a){return/\.(rm|rmvb)(\?|$)/i.test(a)?"audio/x-pn-realaudio-plugin":/\.(swf|flv)(\?|$)/i.test(a)?
'application/x-shockwave-flash"':"video/x-ms-asf-plugin"}function ub(a){return M(unescape(a))}function Qa(a){var b='\x3cembed allowFullScreen\x3d"true" ';n(a,function(a,d){b+=a+'\x3d"'+d+'" '});return b+="/\x3e"}function vb(a,b){var c=b.width,d=b.height,e=b.type||tb(b.src),g=Qa(b),h="";/\D/.test(c)?h+="width:"+c+";":0<c&&(h+="width:"+c+"px;");/\D/.test(d)?h+="height:"+d+";":0<d&&(h+="height:"+d+"px;");c=/realaudio/i.test(e)?"ke-rm":/flash/i.test(e)?"ke-flash":"ke-media";c='\x3cimg class\x3d"'+c+'" src\x3d"'+
a+'" ';""!==h&&(c+='style\x3d"'+h+'" ');return c+='data-ke-tag\x3d"'+escape(g)+'" alt\x3d"" /\x3e'}function fc(a,b){var c=new Function("obj","var p\x3d[],print\x3dfunction(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("\x3c%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%\x3e").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return b?c(b):c}function Ea(a,b){if(9==a.nodeType&&9!=
b.nodeType)return!0;for(;b=b.parentNode;)if(b==a)return!0;return!1}function Fa(a,b){b=b.toLowerCase();var c=null;if(gc||"script"==a.nodeName.toLowerCase())try{c=a.getAttribute(b,2)}catch(d){c=a.getAttribute(b,1)}else{var e=a.ownerDocument.createElement("div");e.appendChild(a.cloneNode(!1));e=M(ja(e.innerHTML));b in e&&(c=e[b])}"style"===b&&null!==c&&(c=dc(c));return c}function Ga(a,b){function c(a){return"string"!=typeof a?a:a.replace(/([^\w\-])/g,"\\$1")}function d(a,b){return"*"===a||a.toLowerCase()===
c(b.toLowerCase())}function e(a,b,c){var e=[];(a=(c.ownerDocument||c).getElementById(a.replace(/\\/g,"")))&&d(b,a.nodeName)&&Ea(c,a)&&e.push(a);return e}function g(a,b,c){var e=c.ownerDocument||c,g=[],h,f,k;if(c.getElementsByClassName)for(e=c.getElementsByClassName(a.replace(/\\/g,"")),h=0,f=e.length;h<f;h++)k=e[h],d(b,k.nodeName)&&g.push(k);else if(e.querySelectorAll)for(e=e.querySelectorAll(("#document"!==c.nodeName?c.nodeName+" ":"")+b+"."+a),h=0,f=e.length;h<f;h++)k=e[h],Ea(c,k)&&g.push(k);else for(e=
c.getElementsByTagName(b),a=" "+a+" ",h=0,f=e.length;h<f;h++)k=e[h],1==k.nodeType&&(b=k.className)&&-1<(" "+b+" ").indexOf(a)&&g.push(k);return g}function h(a,b,d,e){var g=[];d=e.getElementsByTagName(d);for(var h=0,f=d.length;h<f;h++)e=d[h],1==e.nodeType&&(null===b?null!==Fa(e,a)&&g.push(e):b===c(Fa(e,a))&&g.push(e));return g}function f(a,b){var c=[],k,m=(k=/^((?:\\.|[^.#\s\[<>])+)/.exec(a))?k[1]:"*";if(k=/#((?:[\w\-]|\\.)+)$/.exec(a))c=e(k[1],m,b);else if(k=/\.((?:[\w\-]|\\.)+)$/.exec(a))c=g(k[1],
m,b);else if(k=/\[((?:[\w\-]|\\.)+)\]/.exec(a))c=h(k[1].toLowerCase(),null,m,b);else if(k=/\[((?:[\w\-]|\\.)+)\s*=\s*['"]?((?:\\.|[^'"]+)+)['"]?\]/.exec(a))if(c=k[1].toLowerCase(),k=k[2],"id"===c)c=e(k,m,b);else if("class"===c)c=g(k,m,b);else if("name"===c){c=[];k=(b.ownerDocument||b).getElementsByName(k.replace(/\\/g,""));for(var p,r=0,s=k.length;r<s;r++)p=k[r],d(m,p.nodeName)&&Ea(b,p)&&null!==p.getAttribute("name")&&c.push(p)}else c=h(c,k,m,b);else for(m=b.getElementsByTagName(m),p=0,r=m.length;p<
r;p++)k=m[p],1==k.nodeType&&c.push(k);return c}var m=a.split(",");if(1<m.length){var p=[];n(m,function(){n(Ga(this,b),function(){0>N(this,p)&&p.push(this)})});return p}b=b||document;for(var m=[],s,r=/((?:\\.|[^\s>])+|[\s>])/g;s=r.exec(a);)" "!==s[1]&&m.push(s[1]);s=[];if(1==m.length)return f(m[0],b);var r=!1,G,l,q,u,t,B,O,H,w,v;B=0;for(lenth=m.length;B<lenth;B++)if(G=m[B],"\x3e"===G)r=!0;else{if(0<B){l=[];O=0;for(w=s.length;O<w;O++)for(u=s[O],q=f(G,u),H=0,v=q.length;H<v;H++)t=q[H],r?u===t.parentNode&&
l.push(t):l.push(t);s=l}else s=f(G,b);if(0===s.length)return[]}return s}function hc(a,b){var c=Ga(a,b);return 0<c.length?c[0]:null}function Y(a){return a?a.ownerDocument||a.document||a:document}function Z(a){if(!a)return A;a=Y(a);return a.parentWindow||a.defaultView}function ic(a,b){if(1==a.nodeType){var c=Y(a);try{a.innerHTML='\x3cimg id\x3d"__kindeditor_temp_tag__" width\x3d"0" height\x3d"0" style\x3d"display:none;" /\x3e'+b;var d=c.getElementById("__kindeditor_temp_tag__");d.parentNode.removeChild(d)}catch(e){f(a).empty(),
f("@"+b,c).each(function(){a.appendChild(this)})}}}function Ra(a,b,c){q&&8>C&&"class"==b.toLowerCase()&&(b="className");a.setAttribute(b,""+c)}function Sa(a){return a&&a.nodeName?a.nodeName.toLowerCase():""}function jc(a,b){var c=Z(a),d=ka(b),e="";c.getComputedStyle?(c=c.getComputedStyle(a,null),e=c[d]||c.getPropertyValue(b)||a.style[d]):a.currentStyle&&(e=a.currentStyle[d]||a.style[d]);return e}function J(a){a=a||document;return S?a.body:a.documentElement}function ga(a){a=a||document;var b;q||kc||
Ta?(b=J(a).scrollLeft,a=J(a).scrollTop):(b=Z(a).scrollX,a=Z(a).scrollY);return{x:b,y:a}}function F(a){this.init(a)}function wb(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset;return a}function Ua(a,b,c){function d(d,e,g){var h=d.nodeValue.length,m;b&&(m=d.cloneNode(!0),m=0<e?m.splitText(e):m,g<h&&m.splitText(g-e));if(c){var p=d;0<e&&(p=d.splitText(e),a.setStart(d,e));g<h&&(d=p.splitText(g-e),a.setEnd(d,0));f.push(p)}return m}function e(){c&&a.up().collapse(!0);for(var b=
0,d=f.length;b<d;b++){var e=f[b];e.parentNode&&e.parentNode.removeChild(e)}}function g(e,n){for(var l=e.firstChild,q;l;){q=(new P(h)).selectNode(l);p=q.compareBoundaryPoints(oa,a);0<=p&&0>=s&&(s=q.compareBoundaryPoints(pa,a));0<=s&&0>=r&&(r=q.compareBoundaryPoints(ha,a));0<=r&&0>=G&&(G=q.compareBoundaryPoints(qa,a));if(0<=G)return!1;q=l.nextSibling;if(0<p)if(1==l.nodeType)if(0<=s&&0>=r)b&&n.appendChild(l.cloneNode(!0)),c&&f.push(l);else{var u;b&&(u=l.cloneNode(!1),n.appendChild(u));if(!1===g(l,u))return!1}else if(3==
l.nodeType&&(l=l==m.startContainer?d(l,m.startOffset,l.nodeValue.length):l==m.endContainer?d(l,0,m.endOffset):d(l,0,l.nodeValue.length),b))try{n.appendChild(l)}catch(na){}l=q}}var h=a.doc,f=[],m=a.cloneRange().down(),p=-1,s=-1,r=-1,G=-1,n=a.commonAncestor(),l=h.createDocumentFragment();if(3==n.nodeType)return n=d(n,a.startOffset,a.endOffset),b&&l.appendChild(n),e(),b?l:a;g(n,l);c&&a.up().collapse(!0);for(var n=0,q=f.length;n<q;n++){var t=f[n];t.parentNode&&t.parentNode.removeChild(t)}return b?l:a}
function ra(a,b){for(var c=b;c;){var d=f(c);if("marquee"==d.name||"select"==d.name)return;c=c.parentNode}try{a.moveToElementText(b)}catch(e){}}function xb(a,b){var c=a.parentElement().ownerDocument,d=a.duplicate();d.collapse(b);var e=d.parentElement(),g=e.childNodes;if(0===g.length)return{node:e.parentNode,offset:f(e).index()};var h=c,k=0,m=-1,p=a.duplicate();ra(p,e);for(var s=0,r=g.length;s<r;s++){var l=g[s],m=p.compareEndPoints("StartToStart",d);if(0===m)return{node:l.parentNode,offset:s};if(1==
l.nodeType){var n=a.duplicate(),q,u=f(l),t=l;u.isControl()&&(q=c.createElement("span"),u.after(q),t=q,k+=u.text().replace(/\r\n|\n|\r/g,"").length);ra(n,t);p.setEndPoint("StartToEnd",n);k=0<m?k+n.text.replace(/\r\n|\n|\r/g,"").length:0;q&&f(q).remove()}else 3==l.nodeType&&(p.moveStart("character",l.nodeValue.length),k+=l.nodeValue.length);0>m&&(h=l)}if(0>m&&1==h.nodeType)return{node:e,offset:f(e.lastChild).index()+1};if(0<m)for(;h.nextSibling&&1==h.nodeType;)h=h.nextSibling;p=a.duplicate();ra(p,e);
p.setEndPoint("StartToEnd",d);k-=p.text.replace(/\r\n|\n|\r/g,"").length;if(0<m&&3==h.nodeType)for(c=h.previousSibling;c&&3==c.nodeType;)k-=c.nodeValue.length,c=c.previousSibling;return{node:h,offset:k}}function yb(a,b){var c=a.ownerDocument||a,d=c.body.createTextRange();if(c==a)return d.collapse(!0),d;if(1==a.nodeType&&0<a.childNodes.length){var e=a.childNodes,g;0===b?(g=e[0],e=!0):(g=e[b-1],e=!1);if(!g)return d;if("head"===f(g).name)return 1===b&&(e=!0),2===b&&(e=!1),d.collapse(e),d;if(1==g.nodeType){var h=
f(g),k;h.isControl()&&(k=c.createElement("span"),e?h.before(k):h.after(k),g=k);ra(d,g);d.collapse(e);k&&f(k).remove();return d}a=g;b=e?0:g.nodeValue.length}c=c.createElement("span");f(a).before(c);ra(d,c);d.moveStart("character",b);f(c).remove();return d}function zb(a){function b(a){"tr"==f(a.node).name&&(a.node=a.node.cells[a.offset],a.offset=0)}var c;if(K){if(a.item)return c=Y(a.item(0)),c=new P(c),c.selectNode(a.item(0)),c;c=a.parentElement().ownerDocument;var d=xb(a,!0);a=xb(a,!1);b(d);b(a);c=
new P(c);c.setStart(d.node,d.offset);c.setEnd(a.node,a.offset);return c}d=a.startContainer;c=d.ownerDocument||d;c=new P(c);c.setStart(d,a.startOffset);c.setEnd(a.endContainer,a.endOffset);return c}function P(a){this.init(a)}function Va(a){return a.nodeName?new P(a):a.constructor===P?a:zb(a)}function T(a,b,c){try{a.execCommand(b,!1,c)}catch(d){}}function Ab(a,b){var c="";try{c=a.queryCommandValue(b)}catch(d){}"string"!==typeof c&&(c="");return c}function Wa(a){var b=Z(a);return K?a.selection:b.getSelection()}
function Bb(a){var b={},c,d;n(a,function(a,g){c=a.split(",");for(var h=0,f=c.length;h<f;h++)d=c[h],b[d]=g});return b}function Xa(a,b){return Cb(a,b,"*")||Cb(a,b)}function Cb(a,b,c){c=c||a.name;if(1!==a.type)return!1;b=Bb(b);if(!b[c])return!1;c=b[c].split(",");b=0;for(var d=c.length;b<d;b++){var e=c[b];if("*"===e)return!0;var g=/^(\.?)([^=]+)(?:=([^=]*))?$/.exec(e),h=g[1]?"css":"attr",e=g[2],g=g[3]||"";if(""===g&&""!==a[h](e)||""!==g&&a[h](e)===g)return!0}return!1}function Ya(a,b){1==a.type&&(Db(a,
b,"*"),Db(a,b))}function Db(a,b,c){c=c||a.name;if(1===a.type&&(b=Bb(b),b[c])){c=b[c].split(",");b=!1;for(var d=0,e=c.length;d<e;d++){var g=c[d];if("*"===g){b=!0;break}var h=/^(\.?)([^=]+)(?:=([^=]*))?$/.exec(g),g=h[2];h[1]?(g=ka(g),a[0].style[g]&&(a[0].style[g]="")):a.removeAttr(g)}b&&a.remove(!0)}}function Za(a){for(;a.first();)a=a.first();return a}function ia(a){return 1!=a.type||a.isSingle()?!1:""===a.html().replace(/<[^>]+>/g,"")}function lc(a,b,c){n(b,function(b,c){"style"!==b&&a.attr(b,c)});
n(c,function(b,c){a.css(b,c)})}function sa(a){this.init(a)}function Eb(a){a.nodeName&&(a=Y(a),a=Va(a).selectNodeContents(a.body).collapse(!1));return new sa(a)}function $a(a){var b=a.moveEl,c=a.moveFn,d=a.clickEl||b,e=a.beforeDrag,g=[document];(void 0===a.iframeFix||a.iframeFix)&&f("iframe").each(function(){var a=ma(this.src||"","absolute");if(!/^https?:\/\//.test(a)){var b;try{b=ab(this)}catch(c){}b&&(a=f(this).pos(),f(b).data("pos-x",a.x),f(b).data("pos-y",a.y),g.push(b))}});d.mousedown(function(a){function k(a){a.preventDefault();
var b=f(Y(a.target)),e=U((b.data("pos-x")||0)+a.pageX-u);a=U((b.data("pos-y")||0)+a.pageY-v);c.call(d,r,n,q,t,e,a)}function m(a){a.preventDefault()}function p(a){a.preventDefault();f(g).unbind("mousemove",k).unbind("mouseup",p).unbind("selectstart",m);l.releaseCapture&&l.releaseCapture()}a.stopPropagation();var l=d.get(),r=w(b.css("left")),n=w(b.css("top")),q=b.width(),t=b.height(),u=a.pageX,v=a.pageY;e&&e();f(g).mousemove(k).mouseup(p).bind("selectstart",m);l.setCapture&&l.setCapture()})}function V(a){this.init(a)}
function bb(a){return new V(a)}function ab(a){a=f(a)[0];return a.contentDocument||a.contentWindow.document}function mc(a,b,c,d){var e=[""===cb?"\x3chtml\x3e":'\x3chtml dir\x3d"'+cb+'"\x3e','\x3chead\x3e\x3cmeta charset\x3d"utf-8" /\x3e\x3ctitle\x3e\x3c/title\x3e',"\x3cstyle\x3e","html {margin:0;padding:0;}","body {margin:0;padding:5px;}",'body, td {font:12px/1.5 "sans serif",tahoma,verdana,helvetica;}',"body, p, div {word-wrap: break-word;}","p {margin:5px 0;}","table {border-collapse:collapse;}",
"img {border:0;}","noscript {display:none;}","table.ke-zeroborder td {border:1px dotted #AAA;}","img.ke-flash {","\tborder:1px solid #AAA;","\tbackground-image:url("+a+"common/flash.gif);","\tbackground-position:center center;","\tbackground-repeat:no-repeat;","\twidth:100px;","\theight:100px;","}","img.ke-rm {","\tborder:1px solid #AAA;","\tbackground-image:url("+a+"common/rm.gif);","\tbackground-position:center center;","\tbackground-repeat:no-repeat;","\twidth:100px;","\theight:100px;","}","img.ke-media {",
"\tborder:1px solid #AAA;","\tbackground-image:url("+a+"common/media.gif);","\tbackground-position:center center;","\tbackground-repeat:no-repeat;","\twidth:100px;","\theight:100px;","}","img.ke-anchor {","\tborder:1px dashed #666;","\twidth:16px;","\theight:16px;","}",".ke-script, .ke-noscript, .ke-display-none {","\tdisplay:none;","\tfont-size:0;","\twidth:0;","\theight:0;","}",".ke-pagebreak {","\tborder:1px dotted #AAA;","\tfont-size:0;","\theight:2px;","}","\x3c/style\x3e"];ca(c)||(c=[c]);n(c,
function(a,b){b&&e.push('\x3clink href\x3d"'+b+'" rel\x3d"stylesheet" /\x3e')});d&&e.push("\x3cstyle\x3e"+d+"\x3c/style\x3e");e.push("\x3c/head\x3e\x3cbody "+(b?'class\x3d"'+b+'"':"")+"\x3e\x3c/body\x3e\x3c/html\x3e");return e.join("\n")}function ta(a,b){if(a.hasVal()){if(void 0===b){var c=a.val();return c=c.replace(/(<(?:p|p\s[^>]*)>) *(<\/p>)/ig,"")}return a.val(b)}return a.html(b)}function ua(a){this.init(a)}function Fb(a){return new ua(a)}function Gb(a,b){var c=this.get(a);c&&!c.hasClass("ke-disabled")&&
b(c)}function Ha(a){this.init(a)}function Hb(a){return new Ha(a)}function va(a){this.init(a)}function db(a){return new va(a)}function wa(a){this.init(a)}function Ib(a){return new wa(a)}function eb(a){this.init(a)}function nc(a){return new eb(a)}function xa(a){this.init(a)}function Jb(a){return new xa(a)}function oc(a){var b=bb(a),c=b.remove,d=a.afterSelect;a=b.div;var e=[];a.addClass("ke-tabs").bind("contextmenu,mousedown,mousemove",function(a){a.preventDefault()});var g=f('\x3cul class\x3d"ke-tabs-ul ke-clearfix"\x3e\x3c/ul\x3e');
a.append(g);b.add=function(a){var b=f('\x3cli class\x3d"ke-tabs-li"\x3e'+a.title+"\x3c/li\x3e");b.data("tab",a);e.push(b);g.append(b)};b.selectedIndex=0;b.select=function(a){b.selectedIndex=a;n(e,function(c,d){d.unbind();c===a?(d.addClass("ke-tabs-li-selected"),f(d.data("tab").panel).show("")):(d.removeClass("ke-tabs-li-selected").removeClass("ke-tabs-li-on").mouseover(function(){f(this).addClass("ke-tabs-li-on")}).mouseout(function(){f(this).removeClass("ke-tabs-li-on")}).click(function(){b.select(c)}),
f(d.data("tab").panel).hide())});d&&d.call(b,a)};b.remove=function(){n(e,function(){this.remove()});g.remove();c.call(b)};return b}function fb(a,b){var c=document.getElementsByTagName("head")[0]||(S?document.body:document.documentElement),d=document.createElement("script");c.appendChild(d);d.src=a;d.charset="utf-8";d.onload=d.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState||(b&&b(),d.onload=d.onreadystatechange=null,c.removeChild(d))}}function Kb(a){var b=a.indexOf("?");
return 0<b?a.substr(0,b):a}function gb(a){for(var b=document.getElementsByTagName("head")[0]||(S?document.body:document.documentElement),c=document.createElement("link"),d=Kb(ma(a,"absolute")),e=f('link[rel\x3d"stylesheet"]',b),g=0,h=e.length;g<h;g++)if(Kb(ma(e[g].href,"absolute"))===d)return;b.appendChild(c);c.href=a;c.rel="stylesheet"}function pc(a,b,c,d,e){c=c||"GET";e=e||"json";var g=A.XMLHttpRequest?new A.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");g.open(c,a,!0);g.onreadystatechange=
function(){if(4==g.readyState&&200==g.status&&b){var a=D(g.responseText);"json"==e&&(a=ib(a));b(a)}};if("POST"==c){var f=[];n(d,function(a,b){f.push(encodeURIComponent(a)+"\x3d"+encodeURIComponent(b))});try{g.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(k){}g.send(f.join("\x26"))}else g.send(null)}function Lb(a,b){if(void 0===a)return Q;if(!b)return Q[a];Q[a]=b}function Mb(a){var b,c="core";if(b=/^(\w+)\.(\w+)$/.exec(a))c=b[1],a=b[2];return{ns:c,key:a}}function Nb(a,
b){b=void 0===b?f.options.langType:b;if("string"===typeof a){if(!R[b])return"no language";var c=a.length-1;if("."===a.substr(c))return R[b][a.substr(0,c)];c=Mb(a);return R[b][c.ns][c.key]}n(a,function(a,c){var g=Mb(a);R[b]||(R[b]={});R[b][g.ns]||(R[b][g.ns]={});R[b][g.ns][g.key]=c})}function Ia(a,b){if(!a.collapsed){a=a.cloneRange().up();var c=a.startContainer,d=a.startOffset;if((aa||a.isControl())&&(c=f(c.childNodes[d]))&&"img"==c.name&&b(c))return c}}function qc(){var a=this;f(a.edit.doc).contextmenu(function(b){a.menu&&
a.hideMenu();if(!a.useContextmenu)b.preventDefault();else if(0!==a._contextmenus.length){var c=0,d=[];for(n(a._contextmenus,function(){"-"==this.title?d.push(this):this.cond&&this.cond()&&(d.push(this),this.width&&this.width>c&&(c=this.width))});0<d.length&&"-"==d[0].title;)d.shift();for(;0<d.length&&"-"==d[d.length-1].title;)d.pop();var e=null;n(d,function(a){"-"==this.title&&"-"==e.title&&delete d[a];e=this});if(0<d.length){b.preventDefault();var g=f(a.edit.iframe).pos(),h=db({x:g.x+b.clientX,y:g.y+
b.clientY,width:c,css:{visibility:"hidden"},shadowMode:a.shadowMode});n(d,function(){this.title&&h.addItem(this)});var g=J(h.doc),k=h.div.height();b.clientY+k>=g.clientHeight-100&&h.pos(h.x,w(h.y)-k);h.div.css("visibility","visible");a.menu=h}}})}function rc(){function a(a){for(a=f(a.commonAncestor());a&&(1!=a.type||a.isStyle());)a=a.parent();return a.name}var b=this,c=b.edit.doc,d=b.newlineTag;if(!(q&&"br"!==d||ba&&3>C&&"p"!==d||Ta&&9>C)){var e=v("h1,h2,h3,h4,h5,h6,pre,li"),g=v("p,h1,h2,h3,h4,h5,h6,pre,li,blockquote");
f(c).keydown(function(f){if(!(13!=f.which||f.shiftKey||f.ctrlKey||f.altKey)){b.cmd.selection();var k=a(b.cmd.range);"marquee"!=k&&"select"!=k&&("br"!==d||e[k]?g[k]||T(c,"formatblock","\x3cp\x3e"):(f.preventDefault(),b.insertHtml("\x3cbr /\x3e"+(q&&9>C?"":"\u200b"))))}});f(c).keyup(function(e){if(!(13!=e.which||e.shiftKey||e.ctrlKey||e.altKey)&&"br"!=d)if(ba){e=b.cmd.commonAncestor("p");var k=b.cmd.commonAncestor("a");k&&""==k.text()&&(k.remove(!0),b.cmd.range.selectNodeContents(e[0]).collapse(!0),
b.cmd.select())}else if(b.cmd.selection(),e=a(b.cmd.range),"marquee"!=e&&"select"!=e&&(g[e]||T(c,"formatblock","\x3cp\x3e"),e=b.cmd.commonAncestor("div"))){for(var k=f("\x3cp\x3e\x3c/p\x3e"),m=e[0].firstChild;m;){var p=m.nextSibling;k.append(m);m=p}e.before(k);e.remove();b.cmd.range.selectNodeContents(k[0]);b.cmd.select()}})}}function sc(){var a=this,b=a.edit.doc;f(b).keydown(function(c){if(9==c.which)if(c.preventDefault(),a.afterTab)a.afterTab.call(a,c);else{c=a.cmd;var d=c.range;d.shrink();d.collapsed&&
1==d.startContainer.nodeType&&(d.insertNode(f("@\x26nbsp;",b)[0]),c.select());a.insertHtml("\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;")}})}function tc(){var a=this;f(a.edit.textarea[0],a.edit.win).focus(function(b){a.afterFocus&&a.afterFocus.call(a,b)}).blur(function(b){a.afterBlur&&a.afterBlur.call(a,b)})}function W(a){return D(a.replace(/<span [^>]*id="?__kindeditor_bookmark_\w+_\d+__"?[^>]*><\/span>/ig,""))}function Ja(a){return a.replace(/<div[^>]+class="?__kindeditor_paste__"?[^>]*>[\s\S]*?<\/div>/ig,
"")}function Ob(a,b){if(0===a.length)a.push(b);else{var c=a[a.length-1];W(b.html)!==W(c.html)&&a.push(b)}}function Pb(a,b){var c=this.edit,d=c.doc.body,e,g;if(0===a.length)return this;c.designMode?(e=this.cmd.range,g=e.createBookmark(!0),g.html=d.innerHTML):g={html:d.innerHTML};Ob(b,g);var h=a.pop();W(g.html)===W(h.html)&&0<a.length&&(h=a.pop());c.designMode?(c.html(h.html),h.start&&(e.moveToBookmark(h),this.select())):f(d).html(W(h.html));return this}function ya(a){function b(a,b){void 0===ya.prototype[a]&&
(c[a]=b);c.options[a]=b}var c=this;c.options={};n(a,function(c,d){b(c,a[c])});n(f.options,function(a,d){void 0===c[a]&&b(a,d)});var d=f(c.srcElement||"\x3ctextarea/\x3e");c.width||(c.width=d[0].style.width||d.width());c.height||(c.height=d[0].style.height||d.height());b("width",l(c.width,c.minWidth));b("height",l(c.height,c.minHeight));b("width",t(c.width));b("height",t(c.height));uc&&(!vc||534>C)&&(c.designMode=!1);c.srcElement=d;c.initContent="";c.plugin={};c.isCreated=!1;c._handlers={};c._contextmenus=
[];c._undoStack=[];c._redoStack=[];c._firstAddBookmark=!0;c.menu=c.contextmenu=null;c.dialogs=[]}function wc(a){return new ya(a)}function Qb(a,b){function c(a){n(Q,function(b,c){Aa(c)&&c.call(a,KindEditor)});return a.create()}b=b||{};b.basePath=l(b.basePath,f.basePath);b.themesPath=l(b.themesPath,b.basePath+"kindeditor/");b.langPath=l(b.langPath,b.basePath+"kindeditor/");b.pluginsPath=l(b.pluginsPath,b.basePath+"kindeditor/");if(l(b.loadStyleMode,f.options.loadStyleMode)){var d=l(b.themeType,f.options.themeType);
gb(b.themesPath+"default/default.css");gb(b.themesPath+d+"/"+d+".css")}if((d=f(a))&&0!==d.length){if(1<d.length)return d.each(function(){Qb(this,b)}),_instances[0];b.srcElement=d[0];var e=new ya(b);_instances.push(e);if(R[e.langType])return c(e);fb(e.langPath+e.langType+".js?ver\x3d"+encodeURIComponent(f.DEBUG?Ka:La),function(){c(e)});return e}}function za(a,b){f(a).each(function(a,d){f.each(_instances,function(a,c){if(c&&c.srcElement[0]==d)return b.call(c,a),!1})})}if(!A.KindEditor){A.console||(A.console=
{});console.log||(console.log=function(){});var La="4.1.10 (2013-11-23)",L=navigator.userAgent.toLowerCase(),q=-1<L.indexOf("msie")&&-1==L.indexOf("opera"),kc=-1==L.indexOf("msie")&&-1<L.indexOf("trident"),ba=-1<L.indexOf("gecko")&&-1==L.indexOf("khtml"),aa=-1<L.indexOf("applewebkit"),Ta=-1<L.indexOf("opera"),uc=-1<L.indexOf("mobile"),vc=/ipad|iphone|ipod/.test(L),S="CSS1Compat"!=document.compatMode,K=!A.getSelection,Rb=/(?:msie|firefox|webkit|opera)[\/:\s](\d+)/.exec(L),C=Rb?Rb[1]:"0",Ka=(new Date).getTime(),
U=Math.round,f={DEBUG:!1,VERSION:La,IE:q,GECKO:ba,WEBKIT:aa,OPERA:Ta,V:C,TIME:Ka,each:n,isArray:ca,isFunction:Aa,inArray:N,inString:Ba,trim:D,addUnit:t,removeUnit:w,escape:E,unescape:ja,toCamel:ka,toHex:Ca,toMap:v,toArray:Na,undef:l,invalidUrl:Yb,addParam:Zb,extend:I,json:ib},qb=v("a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),rb=v("address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul"),
pb=v("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),Sb=v("b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u"),xc=v("img,table,input,textarea,button"),Pa=v("pre,style,script"),Ma=v("html,head,body,td,tr,table,ol,ul,li");v("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr");var ec=v("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),Tb=v("input,button,textarea,select");f.basePath=$b();f.options={designMode:!0,
fullscreenMode:!1,filterMode:!0,wellFormatMode:!0,shadowMode:!0,loadStyleMode:!0,basePath:f.basePath,themesPath:f.basePath+"kindeditor/",langPath:f.basePath+"kindeditor/",pluginsPath:f.basePath+"kindeditor/",themeType:"default",langType:"zh_CN",urlType:"",newlineTag:"p",resizeType:2,syncType:"form",pasteType:2,dialogAlignType:"page",useContextmenu:!0,fullscreenShortcut:!1,bodyClass:"ke-content",indentChar:"\t",cssPath:"",cssData:"",minWidth:450,minHeight:80,minChangeSize:50,zIndex:811213,items:"source | undo redo | preview print template code cut copy paste plainpaste wordpaste | justifyleft justifycenter justifyright justifyfull insertorderedlist insertunorderedlist indent outdent subscript superscript clearhtml quickformat selectall | fullscreen / formatblock fontname fontsize | forecolor hilitecolor bold italic underline strikethrough lineheight removeformat | image multiimage flash media insertfile table hr baidumap pagebreak anchor link unlink | about".split(" "),
noDisableItems:["source","fullscreen"],colorTable:["#E53333 #E56600 #FF9900 #64451D #DFC5A4 #FFE500".split(" "),"#009900 #006600 #99BB00 #B8D100 #60D978 #00D5FF".split(" "),"#337FE5 #003399 #4C33E5 #9933E5 #CC33E5 #EE33EE".split(" "),"#FFFFFF #CCCCCC #999999 #666666 #333333 #000000".split(" ")],fontSizeTable:"9px 10px 12px 14px 16px 18px 24px 32px".split(" "),htmlTags:{font:"id class color size face .background-color".split(" "),span:"id class .color .background-color .font-size .font-family .background .font-weight .font-style .text-decoration .vertical-align .line-height".split(" "),
div:"id class align .border .margin .padding .text-align .color .background-color .font-size .font-family .font-weight .background .font-style .text-decoration .vertical-align .margin-left".split(" "),table:"id class border cellspacing cellpadding width height align bordercolor .padding .margin .border bgcolor .text-align .color .background-color .font-size .font-family .font-weight .font-style .text-decoration .background .width .height .border-collapse".split(" "),"td,th":"id class align valign width height colspan rowspan bgcolor .text-align .color .background-color .font-size .font-family .font-weight .font-style .text-decoration .vertical-align .background .border".split(" "),
a:["id","class","href","target","name"],embed:"id class src width height type loop autostart quality .width .height align allowscriptaccess".split(" "),img:"id class src width height border alt title align .width .height .border".split(" "),"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":"id class align .text-align .color .background-color .font-size .font-family .background .font-weight .font-style .text-decoration .vertical-align .text-indent .margin-left".split(" "),pre:["id","class"],hr:["id","class",
".page-break-after"],"br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del":["id","class"],iframe:"id class src frameborder width height .width .height".split(" ")},layout:'\x3cdiv class\x3d"container"\x3e\x3cdiv class\x3d"toolbar"\x3e\x3c/div\x3e\x3cdiv class\x3d"edit"\x3e\x3c/div\x3e\x3cdiv class\x3d"statusbar"\x3e\x3c/div\x3e\x3c/div\x3e'};var jb=!1,Ub=v("8,9,13,32,46,48..57,59,61,65..90,106,109..111,188,190..192,219..222"),yc=v("33..40"),hb={};n(Ub,function(a,b){hb[a]=b});n(yc,function(a,b){hb[a]=
b});var zc="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");I(kb,{init:function(a,b){var c=this,d=a.ownerDocument||a.document||a;c.event=b;n(zc,function(a,d){c[d]=b[d]});c.target||(c.target=c.srcElement||d);3===c.target.nodeType&&
(c.target=c.target.parentNode);!c.relatedTarget&&c.fromElement&&(c.relatedTarget=c.fromElement===c.target?c.toElement:c.fromElement);if(null==c.pageX&&null!=c.clientX){var e=d.documentElement,d=d.body;c.pageX=c.clientX+(e&&e.scrollLeft||d&&d.scrollLeft||0)-(e&&e.clientLeft||d&&d.clientLeft||0);c.pageY=c.clientY+(e&&e.scrollTop||d&&d.scrollTop||0)-(e&&e.clientTop||d&&d.clientTop||0)}!c.which&&(c.charCode||0===c.charCode?c.charCode:c.keyCode)&&(c.which=c.charCode||c.keyCode);!c.metaKey&&c.ctrlKey&&
(c.metaKey=c.ctrlKey);c.which||void 0===c.button||(c.which=c.button&1?1:c.button&2?3:c.button&4?2:0);switch(c.which){case 186:c.which=59;break;case 187:case 107:case 43:c.which=61;break;case 189:case 45:c.which=109;break;case 42:c.which=106;break;case 47:c.which=111;break;case 78:c.which=110}96<=c.which&&105>=c.which&&(c.which-=48)},preventDefault:function(){var a=this.event;a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){var a=this.event;a.stopPropagation?a.stopPropagation():
a.cancelBubble=!0},stop:function(){this.preventDefault();this.stopPropagation()}});var da="kindeditor_"+Ka,mb=0,z={},ob=!1;q&&A.attachEvent("onunload",function(){n(z,function(a,b){b.el&&la(b.el)})});f.ctrl=Oa;f.ready=bc;f.formatUrl=ma;f.formatHtml=X;f.getCssList=fa;f.getAttrList=M;f.mediaType=tb;f.mediaAttrs=ub;f.mediaEmbed=Qa;f.mediaImg=vb;f.clearMsWord=sb;f.tmpl=fc;var Vb=document.createElement("div");Vb.setAttribute("className","t");var gc="t"!==Vb.className;f.query=hc;f.queryAll=Ga;I(F,{init:function(a){a=
ca(a)?a:[a];for(var b=0,c=0,d=a.length;c<d;c++)a[c]&&(this[c]=a[c].constructor===F?a[c][0]:a[c],b++);this.length=b;this.doc=Y(this[0]);this.name=Sa(this[0]);this.type=0<this.length?this[0].nodeType:null;this.win=Z(this[0])},each:function(a){for(var b=0;b<this.length&&!1!==a.call(this[b],b,this[b]);b++);return this},bind:function(a,b){this.each(function(){ea(this,a,b)});return this},unbind:function(a,b){this.each(function(){la(this,a,b)});return this},fire:function(a){if(1>this.length)return this;
nb(this[0],a);return this},hasAttr:function(a){return 1>this.length?!1:!!Fa(this[0],a)},attr:function(a,b){var c=this;if(void 0===a)return M(c.outer());if("object"===typeof a)return n(a,function(a,b){c.attr(a,b)}),c;if(void 0===b)return b=1>c.length?null:Fa(c[0],a),null===b?"":b;c.each(function(){Ra(this,a,b)});return c},removeAttr:function(a){this.each(function(){var b=a;q&&8>C&&"class"==b.toLowerCase()&&(b="className");Ra(this,b,"");this.removeAttribute(b)});return this},get:function(a){return 1>
this.length?null:this[a||0]},eq:function(a){return 1>this.length?null:this[a]?new F(this[a]):null},hasClass:function(a){return 1>this.length?!1:Ba(a,this[0].className," ")},addClass:function(a){this.each(function(){Ba(a,this.className," ")||(this.className=D(this.className+" "+a))});return this},removeClass:function(a){this.each(function(){Ba(a,this.className," ")&&(this.className=D(this.className.replace(RegExp("(^|\\s)"+a+"(\\s|$)")," ")))});return this},html:function(a){if(void 0===a)return 1>
this.length||1!=this.type?"":X(this[0].innerHTML);this.each(function(){ic(this,a)});return this},text:function(){return 1>this.length?"":q?this[0].innerText:this[0].textContent},hasVal:function(){return 1>this.length?!1:!!Tb[Sa(this[0])]},val:function(a){if(void 0===a)return 1>this.length?"":this.hasVal()?this[0].value:this.attr("value");this.each(function(){Tb[Sa(this)]?this.value=a:Ra(this,"value",a)});return this},css:function(a,b){var c=this;if(void 0===a)return fa(c.attr("style"));if("object"===
typeof a)return n(a,function(a,b){c.css(a,b)}),c;if(void 0===b)return 1>c.length?"":c[0].style[ka(a)]||jc(c[0],a)||"";c.each(function(){this.style[ka(a)]=b});return c},width:function(a){return void 0===a?1>this.length?0:this[0].offsetWidth:this.css("width",t(a))},height:function(a){return void 0===a?1>this.length?0:this[0].offsetHeight:this.css("height",t(a))},opacity:function(a){this.each(function(){void 0===this.style.opacity?this.style.filter=1==a?"":"alpha(opacity\x3d"+100*a+")":this.style.opacity=
1==a?"":a});return this},data:function(a,b){a="kindeditor_data_"+a;if(void 0===b)return 1>this.length?null:this[0][a];this.each(function(){this[a]=b});return this},pos:function(){var a=this[0],b=0,c=0;if(a)if(a.getBoundingClientRect)a=a.getBoundingClientRect(),c=ga(this.doc),b=a.left+c.x,c=a.top+c.y;else for(;a;)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;return{x:U(b),y:U(c)}},clone:function(a){return 1>this.length?new F([]):new F(this[0].cloneNode(a))},append:function(a){this.each(function(){this.appendChild&&
this.appendChild(f(a)[0])});return this},appendTo:function(a){this.each(function(){f(a)[0].appendChild(this)});return this},before:function(a){this.each(function(){this.parentNode.insertBefore(f(a)[0],this)});return this},after:function(a){this.each(function(){this.nextSibling?this.parentNode.insertBefore(f(a)[0],this.nextSibling):this.parentNode.appendChild(f(a)[0])});return this},replaceWith:function(a){var b=[];this.each(function(c,d){la(d);var e=f(a)[0];d.parentNode.replaceChild(e,d);b.push(e)});
return f(b)},empty:function(){this.each(function(a,b){for(var c=b.firstChild;c&&b.parentNode;){var d=c.nextSibling;c.parentNode.removeChild(c);c=d}});return this},remove:function(a){var b=this;b.each(function(c,d){if(d.parentNode){la(d);if(a)for(var e=d.firstChild;e;){var g=e.nextSibling;d.parentNode.insertBefore(e,d);e=g}d.parentNode.removeChild(d);delete b[c]}});b.length=0;return b},show:function(a){void 0===a&&(a=this._originDisplay||"");return"none"!=this.css("display")?this:this.css("display",
a)},hide:function(){if(1>this.length)return this;this._originDisplay=this[0].style.display;return this.css("display","none")},outer:function(){if(1>this.length)return"";var a=this.doc.createElement("div");a.appendChild(this[0].cloneNode(!0));return X(a.innerHTML)},isSingle:function(){return!!pb[this.name]},isInline:function(){return!!qb[this.name]},isBlock:function(){return!!rb[this.name]},isStyle:function(){return!!Sb[this.name]},isControl:function(){return!!xc[this.name]},contains:function(a){return 1>
this.length?!1:Ea(this[0],f(a)[0])},parent:function(){if(1>this.length)return null;var a=this[0].parentNode;return a?new F(a):null},children:function(){if(1>this.length)return new F([]);for(var a=[],b=this[0].firstChild;b;)3==b.nodeType&&""===D(b.nodeValue)||a.push(b),b=b.nextSibling;return new F(a)},first:function(){var a=this.children();return 0<a.length?a.eq(0):null},last:function(){var a=this.children();return 0<a.length?a.eq(a.length-1):null},index:function(){if(1>this.length)return-1;for(var a=
-1,b=this[0];b;)a++,b=b.previousSibling;return a},prev:function(){if(1>this.length)return null;var a=this[0].previousSibling;return a?new F(a):null},next:function(){if(1>this.length)return null;var a=this[0].nextSibling;return a?new F(a):null},scan:function(a,b){function c(d){for(d=b?d.firstChild:d.lastChild;d;){var e=b?d.nextSibling:d.previousSibling;if(!1===a(d)||!1===c(d))return!1;d=e}}if(!(1>this.length))return b=void 0===b?!0:b,c(this[0]),this}});n("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(a,b){F.prototype[b]=function(a){return a?this.bind(b,a):this.fire(b)}});var Ac=f,f=function(a,b){function c(a){a[0]||(a=[]);return new F(a)}if(void 0!==a&&null!==a){if("string"===typeof a){b&&(b=f(b)[0]);var d=a.length;"@"===a.charAt(0)&&(a=a.substr(1));if(a.length!==d||/<.+>/.test(a)){var d=(b?b.ownerDocument||b:document).createElement("div"),e=[];d.innerHTML='\x3cimg id\x3d"__kindeditor_temp_tag__" width\x3d"0" height\x3d"0" style\x3d"display:none;" /\x3e'+a;for(var g=0,h=d.childNodes.length;g<
h;g++){var k=d.childNodes[g];"__kindeditor_temp_tag__"!=k.id&&e.push(k)}return c(e)}return c(Ga(a,b))}if(a&&a.constructor===F)return a;a.toArray&&(a=a.toArray());return ca(a)?c(a):c(Na(arguments))}};n(Ac,function(a,b){f[a]=b});f.NodeClass=F;A.KindEditor=f;var pa=0,oa=1,ha=2,qa=3,Wb=0;I(P,{init:function(a){this.startContainer=a;this.startOffset=0;this.endContainer=a;this.endOffset=0;this.collapsed=!0;this.doc=a},commonAncestor:function(){function a(a){for(var b=[];a;)b.push(a),a=a.parentNode;return b}
for(var b=a(this.startContainer),c=a(this.endContainer),d=0,e=b.length,g=c.length,f,k;++d&&(f=b[e-d],k=c[g-d],f&&k&&f===k););return b[e-d+1]},setStart:function(a,b){var c=this.doc;this.startContainer=a;this.startOffset=b;this.endContainer===c&&(this.endContainer=a,this.endOffset=b);return wb(this)},setEnd:function(a,b){var c=this.doc;this.endContainer=a;this.endOffset=b;this.startContainer===c&&(this.startContainer=a,this.startOffset=b);return wb(this)},setStartBefore:function(a){return this.setStart(a.parentNode||
this.doc,f(a).index())},setStartAfter:function(a){return this.setStart(a.parentNode||this.doc,f(a).index()+1)},setEndBefore:function(a){return this.setEnd(a.parentNode||this.doc,f(a).index())},setEndAfter:function(a){return this.setEnd(a.parentNode||this.doc,f(a).index()+1)},selectNode:function(a){return this.setStartBefore(a).setEndAfter(a)},selectNodeContents:function(a){var b=f(a);if(3==b.type||b.isSingle())return this.selectNode(a);b=b.children();return 0<b.length?this.setStartBefore(b[0]).setEndAfter(b[b.length-
1]):this.setStart(a,0).setEnd(a,0)},collapse:function(a){return a?this.setEnd(this.startContainer,this.startOffset):this.setStart(this.endContainer,this.endOffset)},compareBoundaryPoints:function(a,b){var c=this.get(),d=b.get();if(K){var e={};e[pa]="StartToStart";e[oa]="EndToStart";e[ha]="EndToEnd";e[qa]="StartToEnd";c=c.compareEndPoints(e[a],d);if(0!==c)return c;var g,h,k,m;if(a===pa||a===qa)g=this.startContainer,k=this.startOffset;if(a===oa||a===ha)g=this.endContainer,k=this.endOffset;if(a===pa||
a===oa)h=b.startContainer,m=b.startOffset;if(a===ha||a===qa)h=b.endContainer,m=b.endOffset;if(g===h)return g=k-m,0<g?1:0>g?-1:0;for(c=h;c&&c.parentNode!==g;)c=c.parentNode;if(c)return f(c).index()>=k?-1:1;for(c=g;c&&c.parentNode!==h;)c=c.parentNode;if(c)return f(c).index()>=m?1:-1;if((c=f(h).next())&&c.contains(g))return 1;if((c=f(g).next())&&c.contains(h))return-1}else return c.compareBoundaryPoints(a,d)},cloneRange:function(){return(new P(this.doc)).setStart(this.startContainer,this.startOffset).setEnd(this.endContainer,
this.endOffset)},toString:function(){var a=this.get();return(K?a.text:a.toString()).replace(/\r\n|\n|\r/g,"")},cloneContents:function(){return Ua(this,!0,!1)},deleteContents:function(){return Ua(this,!1,!0)},extractContents:function(){return Ua(this,!0,!0)},insertNode:function(a){var b=this.startContainer,c=this.startOffset,d=this.endContainer,e=this.endOffset,g,f,k,m=1;"#document-fragment"===a.nodeName.toLowerCase()&&(g=a.firstChild,f=a.lastChild,m=a.childNodes.length);1==b.nodeType?(k=b.childNodes[c])?
(b.insertBefore(a,k),b===d&&(e+=m)):b.appendChild(a):3==b.nodeType&&(0===c?(b.parentNode.insertBefore(a,b),b.parentNode===d&&(e+=m)):c>=b.nodeValue.length?b.nextSibling?b.parentNode.insertBefore(a,b.nextSibling):b.parentNode.appendChild(a):(k=0<c?b.splitText(c):b,b.parentNode.insertBefore(a,k),b===d&&(d=k,e-=c)));g?this.setStartBefore(g).setEndAfter(f):this.selectNode(a);return 1<=this.compareBoundaryPoints(ha,this.cloneRange().setEnd(d,e))?this:this.setEnd(d,e)},surroundContents:function(a){a.appendChild(this.extractContents());
return this.insertNode(a).selectNode(a)},isControl:function(){var a=this.startContainer,b=this.startOffset,c=this.endContainer,d=this.endOffset;return 1==a.nodeType&&a===c&&b+1===d&&f(a.childNodes[b]).isControl()},get:function(a){var b=this.doc;if(!K){b=b.createRange();try{b.setStart(this.startContainer,this.startOffset),b.setEnd(this.endContainer,this.endOffset)}catch(c){}return b}if(a&&this.isControl())return b=b.body.createControlRange(),b.addElement(this.startContainer.childNodes[this.startOffset]),
b;a=this.cloneRange().down();b=b.body.createTextRange();b.setEndPoint("StartToStart",yb(a.startContainer,a.startOffset));b.setEndPoint("EndToStart",yb(a.endContainer,a.endOffset));return b},html:function(){return f(this.cloneContents()).outer()},down:function(){function a(a,d,e){if(1==a.nodeType&&(a=f(a).children(),0!==a.length)){var g,h,k,m;0<d&&(g=a.eq(d-1));d<a.length&&(h=a.eq(d));g&&3==g.type&&(k=g[0],m=k.nodeValue.length);h&&3==h.type&&(k=h[0],m=0);k&&(e?b.setStart(k,m):b.setEnd(k,m))}}var b=
this;a(b.startContainer,b.startOffset,!0);a(b.endContainer,b.endOffset,!1);return b},up:function(){function a(a,d,e){3==a.nodeType&&(0===d?e?b.setStartBefore(a):b.setEndBefore(a):d==a.nodeValue.length&&(e?b.setStartAfter(a):b.setEndAfter(a)))}var b=this;a(b.startContainer,b.startOffset,!0);a(b.endContainer,b.endOffset,!1);return b},enlarge:function(a){function b(b,e,g){b=f(b);if(!(3==b.type||Ma[b.name]||!a&&b.isBlock()))if(0===e){for(;!b.prev();){e=b.parent();if(!e||Ma[e.name]||!a&&e.isBlock())break;
b=e}g?c.setStartBefore(b[0]):c.setEndBefore(b[0])}else if(e==b.children().length){for(;!b.next();){e=b.parent();if(!e||Ma[e.name]||!a&&e.isBlock())break;b=e}g?c.setStartAfter(b[0]):c.setEndAfter(b[0])}}var c=this;c.up();b(c.startContainer,c.startOffset,!0);b(c.endContainer,c.endOffset,!1);return c},shrink:function(){for(var a,b=this.collapsed;1==this.startContainer.nodeType&&(a=this.startContainer.childNodes[this.startOffset])&&1==a.nodeType&&!f(a).isSingle();)this.setStart(a,0);if(b)return this.collapse(b);
for(;1==this.endContainer.nodeType&&0<this.endOffset&&(a=this.endContainer.childNodes[this.endOffset-1])&&1==a.nodeType&&!f(a).isSingle();)this.setEnd(a,a.childNodes.length);return this},createBookmark:function(a){var b,c=f('\x3cspan style\x3d"display:none;"\x3e\x3c/span\x3e',this.doc)[0];c.id="__kindeditor_bookmark_start_"+Wb++ +"__";this.collapsed||(b=c.cloneNode(!0),b.id="__kindeditor_bookmark_end_"+Wb++ +"__");b&&this.cloneRange().collapse(!1).insertNode(b).setEndBefore(b);this.insertNode(c).setStartAfter(c);
return{start:a?"#"+c.id:c,end:b?a?"#"+b.id:b:null}},moveToBookmark:function(a){var b=this.doc,c=f(a.start,b);a=a.end?f(a.end,b):null;if(!c||1>c.length)return this;this.setStartBefore(c[0]);c.remove();a&&0<a.length?(this.setEndBefore(a[0]),a.remove()):this.collapse(!0);return this},dump:function(){console.log("--------------------");console.log(3==this.startContainer.nodeType?this.startContainer.nodeValue:this.startContainer,this.startOffset);console.log(3==this.endContainer.nodeType?this.endContainer.nodeValue:
this.endContainer,this.endOffset)}});f.RangeClass=P;f.range=Va;f.START_TO_START=pa;f.START_TO_END=oa;f.END_TO_END=ha;f.END_TO_START=qa;I(sa,{init:function(a){var b=a.doc;this.doc=b;this.win=Z(b);this.sel=Wa(b);this.range=a},selection:function(a){var b=this.doc,c;c=Wa(b);var d;try{d=0<c.rangeCount?c.getRangeAt(0):c.createRange()}catch(e){}c=!K||d&&(d.item||d.parentElement().ownerDocument===b)?d:null;this.sel=Wa(b);if(c)return this.range=Va(c),"html"==f(this.range.startContainer).name&&this.range.selectNodeContents(b.body).collapse(!1),
this;a&&this.range.selectNodeContents(b.body).collapse(!1);return this},select:function(a){a=l(a,!0);var b=this.sel,c=this.range.cloneRange().shrink(),d=c.startContainer,e=c.startOffset,g=Y(d),h=this.win,k,m=!1;if(a&&1==d.nodeType&&c.collapsed){if(K){b=f("\x3cspan\x3e\x26nbsp;\x3c/span\x3e",g);c.insertNode(b[0]);k=g.body.createTextRange();try{k.moveToElementText(b[0])}catch(p){}k.collapse(!1);k.select();b.remove();h.focus();return this}aa&&(a=d.childNodes,f(d).isInline()||0<e&&f(a[e-1]).isInline()||
a[e]&&f(a[e]).isInline())&&(c.insertNode(g.createTextNode("\u200b")),m=!0)}if(K)try{k=c.get(!0),k.select()}catch(s){}else m&&c.collapse(!1),k=c.get(!0),b.removeAllRanges(),b.addRange(k),g!==document&&(c=f(k.endContainer).pos(),h.scrollTo(c.x,c.y));h.focus();return this},wrap:function(a){var b=this.range,c;c=f(a,this.doc);if(b.collapsed)return b.shrink(),b.insertNode(c[0]).selectNodeContents(c[0]),this;if(c.isBlock()){for(var d=a=c.clone(!0);d.first();)d=d.first();d.append(b.extractContents());b.insertNode(a[0]).selectNode(a[0]);
return this}b.enlarge();var e=b.createBookmark();a=b.commonAncestor();var g=!1;f(a).scan(function(a){if(!g&&a==e.start)g=!0;else if(g){if(a==e.end)return!1;var b=f(a),d;a:{for(d=b;d&&"body"!=d.name;){if(Pa[d.name]||"div"==d.name&&d.hasClass("ke-script")){d=!0;break a}d=d.parent()}d=!1}if(!d&&3==b.type&&0<D(a.nodeValue).length){for(var p;(p=b.parent())&&p.isStyle()&&1==p.children().length;)b=p;p=c;p=p.clone(!0);if(3==b.type)Za(p).append(b.clone(!1)),b.replaceWith(p);else{a=b;for(var l;(l=b.first())&&
1==l.children().length;)b=l;l=b.first();for(b=b.doc.createDocumentFragment();l;)b.appendChild(l[0]),l=l.next();l=a.clone(!0);d=Za(l);for(var r=l,n=!1;p;){for(;r;)r.name===p.name&&(lc(r,p.attr(),p.css()),n=!0),r=r.first();n||d.append(p.clone(!1));n=!1;p=p.first()}p=l;b.firstChild&&Za(p).append(b);a.replaceWith(p)}}}});b.moveToBookmark(e);return this},split:function(a,b){for(var c=this.range,d=c.doc,e=c.cloneRange().collapse(a),g=e.startContainer,h=e.startOffset,k=3==g.nodeType?g.parentNode:g,m=!1,
p;k&&k.parentNode;){p=f(k);if(b){if(!p.isStyle())break;if(!Xa(p,b))break}else if(Ma[p.name])break;m=!0;k=k.parentNode}m&&(d=d.createElement("span"),c.cloneRange().collapse(!a).insertNode(d),a?e.setStartBefore(k.firstChild).setEnd(g,h):e.setStart(g,h).setEndAfter(k.lastChild),g=e.extractContents(),h=g.firstChild,m=g.lastChild,a?(e.insertNode(g),c.setStartAfter(m).setEndBefore(d)):(k.appendChild(g),c.setStartBefore(d).setEndBefore(h)),e=d.parentNode,e==c.endContainer&&(k=f(d).prev(),g=f(d).next(),k&&
g&&3==k.type&&3==g.type?c.setEnd(k[0],k[0].nodeValue.length):a||c.setEnd(c.endContainer,c.endOffset-1)),e.removeChild(d));return this},remove:function(a){var b=this.doc,c=this.range;c.enlarge();if(0===c.startOffset){for(var d=f(c.startContainer),e;(e=d.parent())&&e.isStyle()&&1==e.children().length;)d=e;c.setStart(d[0],0);d=f(c.startContainer);d.isBlock()&&Ya(d,a);(d=d.parent())&&d.isBlock()&&Ya(d,a)}if(c.collapsed)return this.split(!0,a),b=c.startContainer,d=c.startOffset,0<d&&(e=f(b.childNodes[d-
1]))&&ia(e)&&(e.remove(),c.setStart(b,d-1)),(d=f(b.childNodes[d]))&&ia(d)&&d.remove(),ia(b)&&(c.startBefore(b),b.remove()),c.collapse(!0),this;this.split(!0,a);this.split(!1,a);var g=b.createElement("span"),h=b.createElement("span");c.cloneRange().collapse(!1).insertNode(h);c.cloneRange().collapse(!0).insertNode(g);var k=[],m=!1;f(c.commonAncestor()).scan(function(a){if(m||a!=g){if(a==h)return!1;m&&k.push(a)}else m=!0});f(g).remove();f(h).remove();b=c.startContainer;d=c.startOffset;e=c.endContainer;
var p=c.endOffset;if(0<d){var l=f(b.childNodes[d-1]);l&&ia(l)&&(l.remove(),c.setStart(b,d-1),b==e&&c.setEnd(e,p-1));(d=f(b.childNodes[d]))&&ia(d)&&(d.remove(),b==e&&c.setEnd(e,p-1))}(b=f(e.childNodes[c.endOffset]))&&ia(b)&&b.remove();b=c.createBookmark(!0);n(k,function(b,c){Ya(f(c),a)});c.moveToBookmark(b);return this},commonNode:function(a){function b(b){for(var c=b;b;){if(Xa(f(b),a))return f(b);b=b.parentNode}for(;c&&(c=c.lastChild);)if(Xa(f(c),a))return f(c);return null}var c=this.range,d=c.endContainer,
c=c.endOffset,e=3==d.nodeType||0===c?d:d.childNodes[c-1],g=b(e);if(g)return g;if(1==e.nodeType||3==d.nodeType&&0===c)if(d=f(e).prev())return b(d);return null},commonAncestor:function(a){function b(b){for(;b;){if(1==b.nodeType&&b.tagName.toLowerCase()===a)return b;b=b.parentNode}return null}var c=this.range,d=c.startContainer,e=c.startOffset,g=c.endContainer,c=c.endOffset,g=3==g.nodeType||0===c?g:g.childNodes[c-1],d=b(3==d.nodeType||0===e?d:d.childNodes[e-1]),e=b(g);return d&&e&&d===e?f(d):null},state:function(a){var b=
this.doc,c=!1;try{c=b.queryCommandState(a)}catch(d){}return c},val:function(a){var b=this.doc;a=a.toLowerCase();var c="";return"fontfamily"===a||"fontname"===a?(c=Ab(b,"fontname"),c=c.replace(/['"]/g,""),c.toLowerCase()):"formatblock"===a?(c=Ab(b,a),""===c&&(a=this.commonNode({"h1,h2,h3,h4,h5,h6,p,div,pre,address":"*"}))&&(c=a.name),"Normal"===c&&(c="p"),c.toLowerCase()):"fontsize"===a?((a=this.commonNode({"*":".font-size"}))&&(c=a.css("font-size")),c.toLowerCase()):"forecolor"===a?((a=this.commonNode({"*":".color"}))&&
(c=a.css("color")),c=Ca(c),""===c&&(c="default"),c.toLowerCase()):"hilitecolor"===a?((a=this.commonNode({"*":".background-color"}))&&(c=a.css("background-color")),c=Ca(c),""===c&&(c="default"),c.toLowerCase()):c},toggle:function(a,b){this.commonNode(b)?this.remove(b):this.wrap(a);return this.select()},bold:function(){return this.toggle("\x3cstrong\x3e\x3c/strong\x3e",{span:".font-weight\x3dbold",strong:"*",b:"*"})},italic:function(){return this.toggle("\x3cem\x3e\x3c/em\x3e",{span:".font-style\x3ditalic",
em:"*",i:"*"})},underline:function(){return this.toggle("\x3cu\x3e\x3c/u\x3e",{span:".text-decoration\x3dunderline",u:"*"})},strikethrough:function(){return this.toggle("\x3cs\x3e\x3c/s\x3e",{span:".text-decoration\x3dline-through",s:"*"})},forecolor:function(a){return this.wrap('\x3cspan style\x3d"color:'+a+';"\x3e\x3c/span\x3e').select()},hilitecolor:function(a){return this.wrap('\x3cspan style\x3d"background-color:'+a+';"\x3e\x3c/span\x3e').select()},fontsize:function(a){return this.wrap('\x3cspan style\x3d"font-size:'+
a+';"\x3e\x3c/span\x3e').select()},fontname:function(a){return this.fontfamily(a)},fontfamily:function(a){return this.wrap('\x3cspan style\x3d"font-family:'+a+';"\x3e\x3c/span\x3e').select()},removeformat:function(){var a={"*":".font-weight,.font-style,.text-decoration,.color,.background-color,.font-size,.font-family,.text-indent"};n(Sb,function(b,c){a[b]="*"});this.remove(a);return this.select()},inserthtml:function(a,b){function c(a,b){b='\x3cimg id\x3d"__kindeditor_temp_tag__" width\x3d"0" height\x3d"0" style\x3d"display:none;" /\x3e'+
b;var c=a.get();c.item?c.item(0).outerHTML=b:c.pasteHTML(b);var d=a.doc.getElementById("__kindeditor_temp_tag__");d.parentNode.removeChild(d);c=zb(c);a.setEnd(c.endContainer,c.endOffset);a.collapse(!1);e.select(!1)}function d(a,b){var c=a.doc,d=c.createDocumentFragment();f("@"+b,c).each(function(){d.appendChild(this)});a.deleteContents();a.insertNode(d);a.collapse(!1);e.select(!1)}var e=this,g=e.range;if(""===a)return e;if(K&&b){try{c(g,a)}catch(h){d(g,a)}return e}d(g,a);return e},hr:function(){return this.inserthtml("\x3chr /\x3e")},
print:function(){this.win.print();return this},insertimage:function(a,b,c,d,e,g){b=l(b,"");l(e,0);a='\x3cimg src\x3d"'+E(a)+'" data-ke-src\x3d"'+E(a)+'" ';c&&(a+='width\x3d"'+E(c)+'" ');d&&(a+='height\x3d"'+E(d)+'" ');b&&(a+='title\x3d"'+E(b)+'" ');g&&(a+='align\x3d"'+E(g)+'" ');a+='alt\x3d"'+E(b)+'" ';return this.inserthtml(a+"/\x3e")},createlink:function(a,b){function c(a,b,c){f(a).attr("href",b).attr("data-ke-src",b);c?f(a).attr("target",c):f(a).removeAttr("target")}var d=this.doc,e=this.range;
this.select();var g=this.commonNode({a:"*"});g&&!e.isControl()&&(e.selectNode(g.get()),this.select());g='\x3ca href\x3d"'+E(a)+'" data-ke-src\x3d"'+E(a)+'" ';b&&(g+=' target\x3d"'+E(b)+'"');if(e.collapsed)return g+="\x3e"+E(a)+"\x3c/a\x3e",this.inserthtml(g);if(e.isControl()){var h=f(e.startContainer.childNodes[e.startOffset]);h.after(f(g+"\x3e\x3c/a\x3e",d));h.next().append(h);e.selectNode(h[0]);return this.select()}var g=e.startContainer,h=e.startOffset,k=e.endContainer,e=e.endOffset;if(1==g.nodeType&&
g===k&&h+1===e&&(e=g.childNodes[h],"a"==e.nodeName.toLowerCase()))return c(e,a,b),this;T(d,"createlink","__kindeditor_temp_url__");f('a[href\x3d"__kindeditor_temp_url__"]',d).each(function(){c(this,a,b)});return this},unlink:function(){var a=this.doc,b=this.range;this.select();if(b.collapsed){var c=this.commonNode({a:"*"});c&&(b.selectNode(c.get()),this.select());T(a,"unlink",null);aa&&"img"===f(b.startContainer).name&&(a=f(b.startContainer).parent(),"a"===a.name&&a.remove(!0))}else T(a,"unlink",
null);return this}});n("formatblock selectall justifyleft justifycenter justifyright justifyfull insertorderedlist insertunorderedlist indent outdent subscript superscript".split(" "),function(a,b){sa.prototype[b]=function(a){this.select();T(this.doc,b,a);K&&0<=N(b,["justifyleft","justifycenter","justifyright","justifyfull"])&&this.selection();(!K||0<=N(b,["formatblock","selectall","insertorderedlist","insertunorderedlist"]))&&this.selection();return this}});n(["cut","copy","paste"],function(a,b){sa.prototype[b]=
function(){if(!this.doc.queryCommandSupported(b))throw"not supported";this.select();T(this.doc,b,null);return this}});f.CmdClass=sa;f.cmd=Eb;I(V,{init:function(a){var b=this;b.name=a.name||"";b.doc=a.doc||document;b.win=Z(b.doc);b.x=t(a.x);b.y=t(a.y);b.z=a.z;b.width=t(a.width);b.height=t(a.height);b.div=f('\x3cdiv style\x3d"display:block;"\x3e\x3c/div\x3e');b.options=a;b._alignEl=a.alignEl;b.width&&b.div.css("width",b.width);b.height&&b.div.css("height",b.height);b.z&&b.div.css({position:"absolute",
left:b.x,top:b.y,"z-index":b.z});!b.z||void 0!==b.x&&void 0!==b.y||b.autoPos(b.width,b.height);a.cls&&b.div.addClass(a.cls);a.shadowMode&&b.div.addClass("ke-shadow");a.css&&b.div.css(a.css);a.src?f(a.src).replaceWith(b.div):f(b.doc.body).append(b.div);a.html&&b.div.html(a.html);if(a.autoScroll)if(q&&7>C||S){var c=ga();f(b.win).bind("scroll",function(a){var e=ga();a=e.x-c.x;e=e.y-c.y;b.pos(w(b.x)+a,w(b.y)+e,!1)})}else b.div.css("position","fixed")},pos:function(a,b,c){c=l(c,!0);null!==a&&(a=0>a?0:
t(a),this.div.css("left",a),c&&(this.x=a));null!==b&&(b=0>b?0:t(b),this.div.css("top",b),c&&(this.y=b));return this},autoPos:function(a,b){var c=w(a)||0,d=w(b)||0,e=ga();if(this._alignEl){var g=f(this._alignEl),h=g.pos(),c=U(g[0].clientWidth/2-c/2),d=U(g[0].clientHeight/2-d/2);x=0>c?h.x:h.x+c;y=0>d?h.y:h.y+d}else h=J(this.doc),x=U(e.x+(h.clientWidth-c)/2),y=U(e.y+(h.clientHeight-d)/2);q&&7>C||S||(x-=e.x,y-=e.y);return this.pos(x,y)},remove:function(){var a=this;(q&&7>C||S)&&f(a.win).unbind("scroll");
a.div.remove();n(a,function(b){a[b]=null});return this},show:function(){this.div.show();return this},hide:function(){this.div.hide();return this},draggable:function(a){var b=this;a=a||{};a.moveEl=b.div;a.moveFn=function(a,d,e,g,f,k){0>(a+=f)&&(a=0);0>(d+=k)&&(d=0);b.pos(a,d)};$a(a);return b}});f.WidgetClass=V;f.widget=bb;var Xb,cb="";if(Xb=document.getElementsByTagName("html"))cb=Xb[0].dir;I(ua,V,{init:function(a){function b(){var b=ab(c.iframe);b.open();k&&(b.domain=document.domain);b.write(mc(d,
e,g,h));b.close();c.win=c.iframe[0].contentWindow;c.doc=b;var m=Eb(b);c.afterChange(function(a){m.selection()});aa&&f(b).click(function(a){"img"===f(a.target).name&&(m.selection(!0),m.range.selectNode(a.target),m.select())});q&&(c._mousedownHandler=function(){var a=m.range.cloneRange();a.shrink();a.isControl()&&c.blur()},f(document).mousedown(c._mousedownHandler),f(b).keydown(function(a){if(8==a.which){m.selection();var b=m.range;b.isControl()&&(b.collapse(!0),f(b.startContainer.childNodes[b.startOffset]).remove(),
a.preventDefault())}}));c.cmd=m;c.html(ta(c.srcElement));q?(b.body.disabled=!0,b.body.contentEditable=!0,b.body.removeAttribute("disabled")):b.designMode="on";a.afterCreate&&a.afterCreate.call(c);f(b).keydown(function(a){a.ctrlKey&&13==a.which&&$("#form1").submit()})}var c=this;ua.parent.init.call(c,a);c.srcElement=f(a.srcElement);c.div.addClass("ke-edit");c.designMode=l(a.designMode,!0);c.beforeGetHtml=a.beforeGetHtml;c.beforeSetHtml=a.beforeSetHtml;c.afterSetHtml=a.afterSetHtml;var d=l(a.themesPath,
""),e=a.bodyClass,g=a.cssPath,h=a.cssData,k="res:"!=location.protocol&&location.host.replace(/:\d+/,"")!==document.domain,m="document.open();"+(k?'document.domain\x3d"'+document.domain+'";':"")+"document.close();",m=q?' src\x3d"javascript:void(function(){'+encodeURIComponent(m)+'}())"':"";c.iframe=f('\x3ciframe class\x3d"ke-edit-iframe" hidefocus\x3d"true" frameborder\x3d"0"'+m+"\x3e\x3c/iframe\x3e").css("width","100%");c.textarea=f('\x3ctextarea class\x3d"ke-edit-textarea" hidefocus\x3d"true"\x3e\x3c/textarea\x3e').css("width",
"100%");c.tabIndex=isNaN(parseInt(a.tabIndex,10))?c.srcElement.attr("tabindex"):parseInt(a.tabIndex,10);c.iframe.attr("tabindex",c.tabIndex);c.textarea.attr("tabindex",c.tabIndex);c.width&&c.setWidth(c.width);c.height&&c.setHeight(c.height);c.designMode?c.textarea.hide():c.iframe.hide();k&&c.iframe.bind("load",function(a){c.iframe.unbind("load");q?b():setTimeout(b,0)});c.div.append(c.iframe);c.div.append(c.textarea);c.srcElement.hide();!k&&b()},setWidth:function(a){this.width=a=t(a);this.div.css("width",
a);return this},setHeight:function(a){this.height=a=t(a);this.div.css("height",a);this.iframe.css("height",a);if(q&&8>C||S)a=t(w(a)-2);this.textarea.css("height",a);return this},remove:function(){var a=this.doc;f(a.body).unbind();f(a).unbind();f(this.win).unbind();this._mousedownHandler&&f(document).unbind("mousedown",this._mousedownHandler);ta(this.srcElement,this.html());this.srcElement.show();a.write("");this.iframe.unbind();this.textarea.unbind();ua.parent.remove.call(this)},html:function(a,b){var c=
this.doc;if(this.designMode){c=c.body;if(void 0===a)return a=b?"\x3c!doctype html\x3e\x3chtml\x3e"+c.parentNode.innerHTML+"\x3c/html\x3e":c.innerHTML,this.beforeGetHtml&&(a=this.beforeGetHtml(a)),ba&&"\x3cbr /\x3e"==a&&(a=""),a;this.beforeSetHtml&&(a=this.beforeSetHtml(a));q&&9<=C&&(a=a.replace(/(<.*?checked=")checked(".*>)/ig,"$1$2"));f(c).html(a);this.afterSetHtml&&this.afterSetHtml();return this}if(void 0===a)return this.textarea.val();this.textarea.val(a);return this},design:function(a){(void 0===
a?!this.designMode:a)?this.designMode||(a=this.html(),this.designMode=!0,this.html(a),this.textarea.hide(),this.iframe.show()):this.designMode&&(a=this.html(),this.designMode=!1,this.html(a),this.iframe.hide(),this.textarea.show());return this.focus()},focus:function(){this.designMode?this.win.focus():this.textarea[0].focus();return this},blur:function(){if(q){var a=f('\x3cinput type\x3d"text" style\x3d"float:left;width:0;height:0;padding:0;margin:0;border:0;" value\x3d"" /\x3e',this.div);this.div.append(a);
a[0].focus();a.remove()}else this.designMode?this.win.blur():this.textarea[0].blur();return this},afterChange:function(a){function b(b){setTimeout(function(){a(b)},1)}var c=this.doc,d=c.body;f(c).keyup(function(b){b.ctrlKey||b.altKey||!hb[b.which]||a(b)});f(c).mouseup(a).contextmenu(a);f(this.win).blur(a);f(d).bind("paste",b);f(d).bind("cut",b);return this}});f.EditClass=ua;f.edit=Fb;f.iframeDoc=ab;I(Ha,V,{init:function(a){function b(a){a=f(a);if(a.hasClass("ke-outline"))return a;if(a.hasClass("ke-toolbar-icon"))return a.parent()}
function c(a,c){var d=b(a.target);if(d&&!d.hasClass("ke-disabled")&&!d.hasClass("ke-selected"))d[c]("ke-on")}var d=this;Ha.parent.init.call(d,a);d.disableMode=l(a.disableMode,!1);d.noDisableItemMap=v(l(a.noDisableItems,[]));d._itemMap={};d.div.addClass("ke-toolbar").bind("contextmenu,mousedown,mousemove",function(a){a.preventDefault()}).attr("unselectable","on");d.div.mouseover(function(a){c(a,"addClass")}).mouseout(function(a){c(a,"removeClass")}).click(function(a){var c=b(a.target);c&&!c.hasClass("ke-disabled")&&
d.options.click.call(this,a,c.attr("data-name"))})},get:function(a){return this._itemMap[a]?this._itemMap[a]:this._itemMap[a]=f("span.ke-icon-"+a,this.div).parent()},select:function(a){Gb.call(this,a,function(a){a.addClass("ke-selected")});return self},unselect:function(a){Gb.call(this,a,function(a){a.removeClass("ke-selected").removeClass("ke-on")});return self},enable:function(a){if(a=a.get?a:this.get(a))a.removeClass("ke-disabled"),a.opacity(1);return this},disable:function(a){if(a=a.get?a:this.get(a))a.removeClass("ke-selected").addClass("ke-disabled"),
a.opacity(0.5);return this},disableAll:function(a,b){var c=this,d=c.noDisableItemMap;b&&(d=v(b));(void 0===a?!c.disableMode:a)?(f("span.ke-outline",c.div).each(function(){var a=f(this),b=a[0].getAttribute("data-name",2);d[b]||c.disable(a)}),c.disableMode=!0):(f("span.ke-outline",c.div).each(function(){var a=f(this),b=a[0].getAttribute("data-name",2);d[b]||c.enable(a)}),c.disableMode=!1);return c}});f.ToolbarClass=Ha;f.toolbar=Hb;I(va,V,{init:function(a){a.z=a.z||811213;va.parent.init.call(this,a);
this.centerLineMode=l(a.centerLineMode,!0);this.div.addClass("ke-menu").bind("click,mousedown",function(a){a.stopPropagation()}).attr("unselectable","on")},addItem:function(a){if("-"===a.title)this.div.append(f('\x3cdiv class\x3d"ke-menu-separator"\x3e\x3c/div\x3e'));else{var b=f('\x3cdiv class\x3d"ke-menu-item" unselectable\x3d"on"\x3e\x3c/div\x3e'),c=f('\x3cdiv class\x3d"ke-inline-block ke-menu-item-left"\x3e\x3c/div\x3e'),d=f('\x3cdiv class\x3d"ke-inline-block ke-menu-item-right"\x3e\x3c/div\x3e'),
e=t(a.height),g=l(a.iconClass,"");this.div.append(b);e&&(b.css("height",e),d.css("line-height",e));var h;this.centerLineMode&&(h=f('\x3cdiv class\x3d"ke-inline-block ke-menu-item-center"\x3e\x3c/div\x3e'),e&&h.css("height",e));b.mouseover(function(a){f(this).addClass("ke-menu-item-on");h&&h.addClass("ke-menu-item-center-on")}).mouseout(function(a){f(this).removeClass("ke-menu-item-on");h&&h.removeClass("ke-menu-item-center-on")}).click(function(b){a.click.call(f(this));b.stopPropagation()}).append(c);
h&&b.append(h);b.append(d);a.checked&&(g="ke-icon-checked");""!==g&&c.html('\x3cspan class\x3d"ke-inline-block ke-toolbar-icon ke-toolbar-icon-url '+g+'"\x3e\x3c/span\x3e');d.html(a.title);return this}},remove:function(){this.options.beforeRemove&&this.options.beforeRemove.call(this);f(".ke-menu-item",this.div[0]).unbind();va.parent.remove.call(this);return this}});f.MenuClass=va;f.menu=db;I(wa,V,{init:function(a){a.z=a.z||811213;wa.parent.init.call(this,a);var b=a.colors||["#E53333 #E56600 #FF9900 #64451D #DFC5A4 #FFE500".split(" "),
"#009900 #006600 #99BB00 #B8D100 #60D978 #00D5FF".split(" "),"#337FE5 #003399 #4C33E5 #9933E5 #CC33E5 #EE33EE".split(" "),"#FFFFFF #CCCCCC #999999 #666666 #333333 #000000".split(" ")];this.selectedColor=(a.selectedColor||"").toLowerCase();this._cells=[];this.div.addClass("ke-colorpicker").bind("click,mousedown",function(a){a.stopPropagation()}).attr("unselectable","on");a=this.doc.createElement("table");this.div.append(a);a.className="ke-colorpicker-table";a.cellPadding=0;a.cellSpacing=0;a.border=
0;var c=a.insertRow(0),d=c.insertCell(0);d.colSpan=b[0].length;this._addAttr(d,"","ke-colorpicker-cell-top");for(var e=0;e<b.length;e++)for(var c=a.insertRow(e+1),g=0;g<b[e].length;g++)d=c.insertCell(g),this._addAttr(d,b[e][g],"ke-colorpicker-cell")},_addAttr:function(a,b,c){var d=this;a=f(a).addClass(c);d.selectedColor===b.toLowerCase()&&a.addClass("ke-colorpicker-cell-selected");a.attr("title",b||d.options.noColor);a.mouseover(function(a){f(this).addClass("ke-colorpicker-cell-on")});a.mouseout(function(a){f(this).removeClass("ke-colorpicker-cell-on")});
a.click(function(a){a.stop();d.options.click.call(f(this),b)});b?a.append(f('\x3cdiv class\x3d"ke-colorpicker-cell-color" unselectable\x3d"on"\x3e\x3c/div\x3e').css("background-color",b)):a.html(d.options.noColor);f(a).attr("unselectable","on");d._cells.push(a)},remove:function(){n(this._cells,function(){this.unbind()});wa.parent.remove.call(this);return this}});f.ColorPickerClass=wa;f.colorpicker=Ib;I(eb,{init:function(a){var b=f(a.button),c=a.fieldName||"file",d=a.url||"",e=b.val(),g=a.extraParams||
{},h=b[0].className||"",k=a.target||"kindeditor_upload_iframe_"+(new Date).getTime();a.afterError=a.afterError||function(a){alert(a)};var m=[],l;for(l in g)m.push('\x3cinput type\x3d"hidden" name\x3d"'+l+'" value\x3d"'+g[l]+'" /\x3e');c=['\x3cdiv class\x3d"ke-inline-block '+h+'"\x3e',a.target?"":'\x3ciframe name\x3d"'+k+'" style\x3d"display:none;"\x3e\x3c/iframe\x3e',a.form?'\x3cdiv class\x3d"ke-upload-area"\x3e':'\x3cform class\x3d"ke-upload-area ke-form" method\x3d"post" enctype\x3d"multipart/form-data" target\x3d"'+
k+'" action\x3d"'+d+'"\x3e','\x3cspan class\x3d"ke-button-common"\x3e',m.join(""),'\x3cinput type\x3d"button" class\x3d"ke-button-common ke-button" value\x3d"'+e+'" /\x3e',"\x3c/span\x3e",'\x3cinput type\x3d"file" class\x3d"ke-upload-file" name\x3d"'+c+'" tabindex\x3d"-1" /\x3e',a.form?"\x3c/div\x3e":"\x3c/form\x3e","\x3c/div\x3e"].join("");c=f(c,b.doc);b.hide();b.before(c);this.div=c;this.button=b;this.iframe=a.target?f('iframe[name\x3d"'+k+'"]'):f("iframe",c);this.form=a.form?f(a.form):f("form",
c);this.fileBox=f(".ke-upload-file",c);b=a.width||f(".ke-button-common",c).width();f(".ke-upload-area",c).width(b);this.options=a},submit:function(){var a=this,b=a.iframe;b.bind("load",function(){b.unbind();var c=document.createElement("form");a.fileBox.before(c);f(c).append(a.fileBox);c.reset();f(c).remove(!0);var c=f.iframeDoc(b),d=c.getElementsByTagName("pre")[0],e="",g,e=d?d.innerHTML:c.body.innerHTML,e=ja(e);b[0].src="javascript:false";try{g=f.json(e)}catch(h){a.options.afterError.call(a,"\x3c!doctype html\x3e\x3chtml\x3e"+
c.body.parentNode.innerHTML+"\x3c/html\x3e")}g&&a.options.afterUpload.call(a,g)});a.form[0].submit();return a},remove:function(){this.fileBox&&this.fileBox.unbind();this.iframe.remove();this.div.remove();this.button.show();return this}});f.UploadButtonClass=eb;f.uploadbutton=nc;I(xa,V,{init:function(a){var b=l(a.shadowMode,!0);a.z=a.z||811213;a.shadowMode=!1;a.autoScroll=l(a.autoScroll,!0);xa.parent.init.call(this,a);var c=a.title,d=f(a.body,this.doc),e=a.previewBtn,g=a.yesBtn,h=a.noBtn,k=a.closeBtn,
m=l(a.showMask,!0);this.div.addClass("ke-dialog").bind("click,mousedown",function(a){a.stopPropagation()});var p=f('\x3cdiv class\x3d"ke-dialog-content"\x3e\x3c/div\x3e').appendTo(this.div);q&&7>C?this.iframeMask=f('\x3ciframe src\x3d"about:blank" class\x3d"ke-dialog-shadow"\x3e\x3c/iframe\x3e').appendTo(this.div):b&&f('\x3cdiv class\x3d"ke-dialog-shadow"\x3e\x3c/div\x3e').appendTo(this.div);b=f('\x3cdiv class\x3d"ke-dialog-header"\x3e\x3c/div\x3e');p.append(b);b.html(c);this.closeIcon=f('\x3cspan class\x3d"ke-dialog-icon-close" title\x3d"'+
k.name+'"\x3e\x3c/span\x3e').click(k.click);b.append(this.closeIcon);this.draggable({clickEl:b,beforeDrag:a.beforeDrag});a=f('\x3cdiv class\x3d"ke-dialog-body"\x3e\x3c/div\x3e');p.append(a);a.append(d);var s=f('\x3cdiv class\x3d"ke-dialog-footer"\x3e\x3c/div\x3e');(e||g||h)&&p.append(s);n([{btn:e,name:"preview"},{btn:g,name:"yes"},{btn:h,name:"no"}],function(){if(this.btn){var a=this.btn,a=a||{},b=a.name||"",c=f('\x3cspan class\x3d"ke-button-common ke-button-outer" title\x3d"'+b+'"\x3e\x3c/span\x3e'),
b=f('\x3cinput class\x3d"ke-button-common ke-button" type\x3d"button" value\x3d"'+b+'" /\x3e');a.click&&b.click(a.click);c.append(b);c.addClass("ke-dialog-"+this.name);s.append(c)}});this.height&&a.height(w(this.height)-b.height()-s.height());this.div.width(this.div.width());this.div.height(this.div.height());this.mask=null;m&&(e=J(this.doc),d=Math.max(e.scrollWidth,e.clientWidth),e=Math.max(e.scrollHeight,e.clientHeight),this.mask=bb({x:0,y:0,z:this.z-1,cls:"ke-dialog-mask",width:d,height:e}));this.autoPos(this.div.width(),
this.div.height());this.footerDiv=s;this.bodyDiv=a;this.headerDiv=b;this.isLoading=!1},setMaskIndex:function(a){this.mask.div.css("z-index",a)},showLoading:function(a){a=l(a,"");var b=this.bodyDiv;this.loading=f('\x3cdiv class\x3d"ke-dialog-loading"\x3e\x3cdiv class\x3d"ke-inline-block ke-dialog-loading-content" style\x3d"margin-top:'+Math.round(b.height()/3)+'px;"\x3e'+a+"\x3c/div\x3e\x3c/div\x3e").width(b.width()).height(b.height()).css("top",this.headerDiv.height()+"px");b.css("visibility","hidden").after(this.loading);
this.isLoading=!0;return this},hideLoading:function(){this.loading&&this.loading.remove();this.bodyDiv.css("visibility","visible");this.isLoading=!1;return this},remove:function(){this.options.beforeRemove&&this.options.beforeRemove.call(this);this.mask&&this.mask.remove();this.iframeMask&&this.iframeMask.remove();this.closeIcon.unbind();f("input",this.div).unbind();f("button",this.div).unbind();this.footerDiv.unbind();this.bodyDiv.unbind();this.headerDiv.unbind();f("iframe",this.div).each(function(){f(this).remove()});
xa.parent.remove.call(this);return this}});f.DialogClass=xa;f.dialog=Jb;f.tabs=oc;f.loadScript=fb;f.loadStyle=gb;f.ajax=pc;var Q={},R={};ya.prototype={lang:function(a){return Nb(a,this.langType)},loadPlugin:function(a,b){var c=this;if(Q[a]){if(!Aa(Q[a]))return setTimeout(function(){c.loadPlugin(a,b)},100),c;Q[a].call(c,KindEditor);b&&b.call(c);return c}Q[a]="loading";fb(c.pluginsPath+a+"/"+a+".js?ver\x3d"+encodeURIComponent(f.DEBUG?Ka:La),function(){setTimeout(function(){Q[a]&&c.loadPlugin(a,b)},
0)});return c},handler:function(a,b){var c=this;c._handlers[a]||(c._handlers[a]=[]);if(Aa(b))return c._handlers[a].push(b),c;n(c._handlers[a],function(){b=this.call(c,b)});return b},clickToolbar:function(a,b){var c=this,d="clickToolbar"+a;if(void 0===b){if(c._handlers[d])return c.handler(d);c.loadPlugin(a,function(){c.handler(d)});return c}return c.handler(d,b)},updateState:function(){var a=this;n("justifyleft justifycenter justifyright justifyfull insertorderedlist insertunorderedlist subscript superscript bold italic underline strikethrough".split(" "),
function(b,c){a.cmd.state(c)?a.toolbar.select(c):a.toolbar.unselect(c)});return a},addContextmenu:function(a){this._contextmenus.push(a);return this},afterCreate:function(a){return this.handler("afterCreate",a)},beforeRemove:function(a){return this.handler("beforeRemove",a)},beforeGetHtml:function(a){return this.handler("beforeGetHtml",a)},beforeSetHtml:function(a){return this.handler("beforeSetHtml",a)},afterSetHtml:function(a){return this.handler("afterSetHtml",a)},create:function(){function a(){0===
m.height()?setTimeout(a,100):b.resize(d,e,!1)}var b=this,c=b.fullscreenMode;if(b.isCreated||b.srcElement.data("kindeditor"))return b;b.srcElement.data("kindeditor","true");c?J().style.overflow="hidden":J().style.overflow="";var d=c?J().clientWidth+"px":b.width,e=c?J().clientHeight+"px":b.height;if(q&&8>C||S)e=t(w(e)+2);var g=b.container=f(b.layout);c?f(document.body).append(g):b.srcElement.before(g);var h=f(".toolbar",g),k=f(".edit",g),m=b.statusbar=f(".statusbar",g);g.removeClass("container").addClass("ke-container ke-container-"+
b.themeType).css("width",d);c?(g.css({position:"absolute",left:0,top:0,"z-index":811211}),ba||(b._scrollPos=ga()),A.scrollTo(0,0),f(document.body).css({height:"1px",overflow:"hidden"}),f(document.body.parentNode).css("overflow","hidden"),b._fullscreenExecuted=!0):(b._fullscreenExecuted&&(f(document.body).css({height:"",overflow:""}),f(document.body.parentNode).css("overflow","")),b._scrollPos&&A.scrollTo(b._scrollPos.x,b._scrollPos.y));var l=[];f.each(b.items,function(a,c){"|"==c?l.push('\x3cspan class\x3d"ke-inline-block ke-separator"\x3e\x3c/span\x3e'):
"/"==c?l.push('\x3cdiv class\x3d"ke-hr"\x3e\x3c/div\x3e'):(l.push('\x3cspan class\x3d"ke-outline" data-name\x3d"'+c+'" title\x3d"'+b.lang(c)+'" unselectable\x3d"on"\x3e'),l.push('\x3cspan class\x3d"ke-toolbar-icon ke-toolbar-icon-url ke-icon-'+c+'" unselectable\x3d"on"\x3e\x3c/span\x3e\x3c/span\x3e'))});var h=b.toolbar=Hb({src:h,html:l.join(""),noDisableItems:b.noDisableItems,click:function(a,c){a.stop();if(b.menu){var d=b.menu.name;b.hideMenu();if(d===c)return}b.clickToolbar(c)}}),n=w(e)-h.div.height(),
r=b.edit=Fb({height:0<n&&w(e)>b.minHeight?n:b.minHeight,src:k,srcElement:b.srcElement,designMode:b.designMode,themesPath:b.themesPath,bodyClass:b.bodyClass,cssPath:b.cssPath,cssData:b.cssData,beforeGetHtml:function(a){a=b.beforeGetHtml(a);a=W(Ja(a));return X(a,b.filterMode?b.htmlTags:null,b.urlType,b.wellFormatMode,b.indentChar)},beforeSetHtml:function(a){a=X(a,b.filterMode?b.htmlTags:null,"",!1);return b.beforeSetHtml(a)},afterSetHtml:function(){b.edit=r=this;b.afterSetHtml()},afterCreate:function(){b.edit=
r=this;b.cmd=r.cmd;b._docMousedownFn=function(a){b.menu&&b.hideMenu()};f(r.doc,document).mousedown(b._docMousedownFn);qc.call(b);rc.call(b);sc.call(b);tc.call(b);r.afterChange(function(a){r.designMode&&(b.updateState(),b.addBookmark(),b.options.afterChange&&b.options.afterChange.call(b))});r.textarea.keyup(function(a){a.ctrlKey||a.altKey||!Ub[a.which]||b.options.afterChange&&b.options.afterChange.call(b)});b.readonlyMode&&b.readonly();b.isCreated=!0;""===b.initContent&&(b.initContent=b.html());if(0<
b._undoStack.length){var a=b._undoStack.pop();a.start&&(b.html(a.html),r.cmd.range.moveToBookmark(a),b.select())}b.afterCreate();b.options.afterCreate&&b.options.afterCreate.call(b)}});m.removeClass("statusbar").addClass("ke-statusbar").append('\x3cspan class\x3d"ke-inline-block ke-statusbar-center-icon"\x3e\x3c/span\x3e').append('\x3cspan class\x3d"ke-inline-block ke-statusbar-right-icon"\x3e\x3c/span\x3e');b._fullscreenResizeHandler&&(f(A).unbind("resize",b._fullscreenResizeHandler),b._fullscreenResizeHandler=
null);a();c?(b._fullscreenResizeHandler=function(a){b.isCreated&&b.resize(J().clientWidth,J().clientHeight,!1)},f(A).bind("resize",b._fullscreenResizeHandler),h.select("fullscreen"),m.first().css("visibility","hidden"),m.last().css("visibility","hidden")):(ba&&f(A).bind("scroll",function(a){b._scrollPos=ga()}),0<b.resizeType?$a({moveEl:g,clickEl:m,moveFn:function(a,c,d,e,g,f){b.resize(null,e+f)}}):m.first().css("visibility","hidden"),2===b.resizeType?$a({moveEl:g,clickEl:m.last(),moveFn:function(a,
c,d,e,g,f){b.resize(d+g,e+f)}}):m.last().css("visibility","hidden"));return b},remove:function(){var a=this;if(!a.isCreated)return a;a.beforeRemove();a.srcElement.data("kindeditor","");a.menu&&a.hideMenu();n(a.dialogs,function(){a.hideDialog()});f(document).unbind("mousedown",a._docMousedownFn);a.toolbar.remove();a.edit.remove();a.statusbar.last().unbind();a.statusbar.unbind();a.container.remove();a.container=a.toolbar=a.edit=a.menu=null;a.dialogs=[];a.isCreated=!1;return a},resize:function(a,b,c){c=
l(c,!0);a&&(/%/.test(a)||(a=w(a),a=a<this.minWidth?this.minWidth:a),this.container.css("width",t(a)),c&&(this.width=t(a)));b&&(b=w(b),editHeight=w(b)-this.toolbar.div.height()-this.statusbar.height(),editHeight=editHeight<this.minHeight?this.minHeight:editHeight,this.edit.setHeight(editHeight),c&&(this.height=t(b)));return this},select:function(){this.isCreated&&this.cmd.select();return this},html:function(a){if(void 0===a)return this.isCreated?this.edit.html():ta(this.srcElement);this.isCreated?
this.edit.html(a):ta(this.srcElement,a);this.isCreated&&this.cmd.selection();return this},fullHtml:function(){return this.isCreated?this.edit.html(void 0,!0):""},text:function(a){return void 0===a?D(this.html().replace(/<(?!img|embed).*?>/ig,"").replace(/&nbsp;/ig," ")):this.html(E(a))},isEmpty:function(){return""===D(this.text().replace(/\r\n|\n|\r/,""))},isDirty:function(){return D(this.initContent.replace(/\r\n|\n|\r|t/g,""))!==D(this.html().replace(/\r\n|\n|\r|t/g,""))},selectedHtml:function(){var a=
this.isCreated?this.cmd.range.html():"";return a=W(Ja(a))},count:function(a){a=(a||"html").toLowerCase();return"html"===a?this.html().length:"text"===a?this.text().replace(/<(?:img|embed).*?>/ig,"K").replace(/\r\n|\n|\r/g,"").length:0},exec:function(a){a=a.toLowerCase();var b=this.cmd,c=0>N(a,["selectall","copy","paste","print"]);c&&this.addBookmark(!1);b[a].apply(b,Na(arguments,1));c&&(this.updateState(),this.addBookmark(!1),this.options.afterChange&&this.options.afterChange.call(this));return this},
insertHtml:function(a,b){if(!this.isCreated)return this;a=this.beforeSetHtml(a);this.exec("inserthtml",a,b);return this},appendHtml:function(a){this.html(this.html()+a);this.isCreated&&(a=this.cmd,a.range.selectNodeContents(a.doc.body).collapse(!1),a.select());return this},sync:function(){ta(this.srcElement,this.html());return this},focus:function(){this.isCreated?this.edit.focus():this.srcElement[0].focus();return this},blur:function(){this.isCreated?this.edit.blur():this.srcElement[0].blur();return this},
addBookmark:function(a){a=l(a,!0);var b=this.edit,c=b.doc.body,d=Ja(c.innerHTML);if(a&&0<this._undoStack.length&&Math.abs(d.length-W(this._undoStack[this._undoStack.length-1].html).length)<this.minChangeSize)return this;b.designMode&&!this._firstAddBookmark?(b=this.cmd.range,a=b.createBookmark(!0),a.html=Ja(c.innerHTML),b.moveToBookmark(a)):a={html:d};this._firstAddBookmark=!1;Ob(this._undoStack,a);return this},undo:function(){return Pb.call(this,this._undoStack,this._redoStack)},redo:function(){return Pb.call(this,
this._redoStack,this._undoStack)},fullscreen:function(a){this.fullscreenMode=void 0===a?!this.fullscreenMode:a;this.addBookmark(!1);return this.remove().create()},readonly:function(a){a=l(a,!0);var b=this,c=b.edit,d=c.doc;b.designMode?b.toolbar.disableAll(a,[]):n(b.noDisableItems,function(){b.toolbar[a?"disable":"enable"](this)});q?d.body.contentEditable=!a:d.designMode=a?"off":"on";c.textarea[0].disabled=a},createMenu:function(a){var b=this.toolbar.get(a.name),c=b.pos();a.x=c.x;a.y=c.y+b.height();
a.z=this.options.zIndex;a.shadowMode=l(a.shadowMode,this.shadowMode);void 0!==a.selectedColor?(a.cls="ke-colorpicker-"+this.themeType,a.noColor=this.lang("noColor"),this.menu=Ib(a)):(a.cls="ke-menu-"+this.themeType,a.centerLineMode=!1,this.menu=db(a));return this.menu},hideMenu:function(){this.menu.remove();this.menu=null;return this},hideContextmenu:function(){this.contextmenu.remove();this.contextmenu=null;return this},createDialog:function(a){var b=this;a.z=b.options.zIndex;a.shadowMode=l(a.shadowMode,
b.shadowMode);a.closeBtn=l(a.closeBtn,{name:b.lang("close"),click:function(a){b.hideDialog();q&&b.cmd&&b.cmd.select()}});a.noBtn=l(a.noBtn,{name:b.lang(a.yesBtn?"no":"close"),click:function(a){b.hideDialog();q&&b.cmd&&b.cmd.select()}});"page"!=b.dialogAlignType&&(a.alignEl=b.container);a.cls="ke-dialog-"+b.themeType;if(0<b.dialogs.length){var c=b.dialogs[b.dialogs.length-1];b.dialogs[0].setMaskIndex(c.z+2);a.z=c.z+3;a.showMask=!1}a=Jb(a);b.dialogs.push(a);return a},hideDialog:function(){0<this.dialogs.length&&
this.dialogs.pop().remove();0<this.dialogs.length&&this.dialogs[0].setMaskIndex(this.dialogs[this.dialogs.length-1].z-1);return this},errorDialog:function(a){var b=this.createDialog({width:750,title:this.lang("uploadError"),body:'\x3cdiv style\x3d"padding:10px 20px;"\x3e\x3ciframe frameborder\x3d"0" style\x3d"width:708px;height:400px;"\x3e\x3c/iframe\x3e\x3c/div\x3e'}),b=f("iframe",b.div),c=f.iframeDoc(b);c.open();c.write(a);c.close();f(c.body).css("background-color","#FFF");b[0].contentWindow.focus();
return this}};_instances=[];f.remove=function(a){za(a,function(a){this.remove();_instances.splice(a,1)})};f.sync=function(a){za(a,function(){this.sync()})};f.html=function(a,b){za(a,function(){this.html(b)})};f.insertHtml=function(a,b){za(a,function(){this.insertHtml(b)})};f.appendHtml=function(a,b){za(a,function(){this.appendHtml(b)})};q&&7>C&&T(document,"BackgroundImageCache",!0);f.EditorClass=ya;f.editor=wc;f.create=Qb;f.instances=_instances;f.plugin=Lb;f.lang=Nb;Lb("core",function(a){var b=this,
c={undo:"Z",redo:"Y",bold:"B",italic:"I",underline:"U",print:"P",selectall:"A"};b.afterSetHtml(function(){b.options.afterChange&&b.options.afterChange.call(b)});b.afterCreate(function(){if("form"==b.syncType){for(var c=a(b.srcElement),d=!1;c=c.parent();)if("form"==c.name){d=!0;break}if(d){c.bind("submit",function(c){b.sync();a(A).bind("unload",function(){b.edit.textarea.remove()})});var f=a('[type\x3d"reset"]',c);f.click(function(){b.html(b.initContent);b.cmd.selection()});b.beforeRemove(function(){c.unbind();
f.unbind()})}}});b.clickToolbar("source",function(){b.edit.designMode?(b.toolbar.disableAll(!0),b.edit.design(!1),b.toolbar.select("source")):(b.toolbar.disableAll(!1),b.edit.design(!0),b.toolbar.unselect("source"),ba?setTimeout(function(){b.cmd.selection()},0):b.cmd.selection());b.designMode=b.edit.designMode});b.afterCreate(function(){b.designMode||b.toolbar.disableAll(!0).select("source")});b.clickToolbar("fullscreen",function(){b.fullscreen()});if(b.fullscreenShortcut){var d=!1;b.afterCreate(function(){a(b.edit.doc,
b.edit.textarea).keyup(function(a){27==a.which&&setTimeout(function(){b.fullscreen()},0)});if(d){if(q&&!b.designMode)return;b.focus()}d||(d=!0)})}n(["undo","redo"],function(a,d){c[d]&&b.afterCreate(function(){Oa(this.edit.doc,c[d],function(){b.clickToolbar(d)})});b.clickToolbar(d,function(){b[d]()})});b.clickToolbar("formatblock",function(){var a=b.lang("formatblock.formatBlock"),c={h1:28,h2:24,h3:18,H4:14,p:12},d=b.cmd.val("formatblock"),f=b.createMenu({name:"formatblock",width:"en"==b.langType?
200:150});n(a,function(a,e){var l="font-size:"+c[a]+"px;";"h"===a.charAt(0)&&(l+="font-weight:bold;");f.addItem({title:'\x3cspan style\x3d"'+l+'" unselectable\x3d"on"\x3e'+e+"\x3c/span\x3e",height:c[a]+12,checked:d===a||d===e,click:function(){b.select().exec("formatblock","\x3c"+a+"\x3e").hideMenu()}})})});b.clickToolbar("fontname",function(){var a=b.cmd.val("fontname"),c=b.createMenu({name:"fontname",width:150});n(b.lang("fontname.fontName"),function(d,f){c.addItem({title:'\x3cspan style\x3d"font-family: '+
d+';" unselectable\x3d"on"\x3e'+f+"\x3c/span\x3e",checked:a===d.toLowerCase()||a===f.toLowerCase(),click:function(){b.exec("fontname",d).hideMenu()}})})});b.clickToolbar("fontsize",function(){var a=b.cmd.val("fontsize"),c=b.createMenu({name:"fontsize",width:150});n(b.fontSizeTable,function(d,f){c.addItem({title:'\x3cspan style\x3d"font-size:'+f+';" unselectable\x3d"on"\x3e'+f+"\x3c/span\x3e",height:w(f)+12,checked:a===f,click:function(){b.exec("fontsize",f).hideMenu()}})})});n(["forecolor","hilitecolor"],
function(a,c){b.clickToolbar(c,function(){b.createMenu({name:c,selectedColor:b.cmd.val(c)||"default",colors:b.colorTable,click:function(a){b.exec(c,a).hideMenu()}})})});n(["cut","copy","paste"],function(a,c){b.clickToolbar(c,function(){b.focus();try{b.exec(c,null)}catch(a){alert(b.lang(c+"Error"))}})});b.clickToolbar("about",function(){var a='\x3cdiv style\x3d"margin:20px;"\x3e\x3cdiv\x3eKindEditor '+La+'\x3c/div\x3e\x3cdiv\x3eCopyright \x26copy; \x3ca href\x3d"http://www.kindsoft.net/" target\x3d"_blank"\x3ekindsoft.net\x3c/a\x3e All rights reserved.\x3c/div\x3e\x3c/div\x3e';
b.createDialog({name:"about",width:350,title:b.lang("about"),body:a})});b.plugin.getSelectedLink=function(){return b.cmd.commonAncestor("a")};b.plugin.getSelectedImage=function(){return Ia(b.edit.cmd.range,function(a){return!/^ke-\w+$/i.test(a[0].className)})};b.plugin.getSelectedFlash=function(){return Ia(b.edit.cmd.range,function(a){return"ke-flash"==a[0].className})};b.plugin.getSelectedMedia=function(){return Ia(b.edit.cmd.range,function(a){return"ke-media"==a[0].className||"ke-rm"==a[0].className})};
b.plugin.getSelectedAnchor=function(){return Ia(b.edit.cmd.range,function(a){return"ke-anchor"==a[0].className})};n(["link","image","flash","media","anchor"],function(a,c){var d=c.charAt(0).toUpperCase()+c.substr(1);n(["edit","delete"],function(a,e){b.addContextmenu({title:b.lang(e+d),click:function(){b.loadPlugin(c,function(){b.plugin[c][e]();b.hideMenu()})},cond:b.plugin["getSelected"+d],width:150,iconClass:"edit"==e?"ke-icon-"+c:void 0})});b.addContextmenu({title:"-"})});b.plugin.getSelectedTable=
function(){return b.cmd.commonAncestor("table")};b.plugin.getSelectedRow=function(){return b.cmd.commonAncestor("tr")};b.plugin.getSelectedCell=function(){return b.cmd.commonAncestor("td")};n("prop cellprop colinsertleft colinsertright rowinsertabove rowinsertbelow rowmerge colmerge rowsplit colsplit coldelete rowdelete insert delete".split(" "),function(a,c){var d=0>N(c,["prop","delete"])?b.plugin.getSelectedCell:b.plugin.getSelectedTable;b.addContextmenu({title:b.lang("table"+c),click:function(){b.loadPlugin("table",
function(){b.plugin.table[c]();b.hideMenu()})},cond:d,width:170,iconClass:"ke-icon-table"+c})});b.addContextmenu({title:"-"});n("selectall justifyleft justifycenter justifyright justifyfull insertorderedlist insertunorderedlist indent outdent subscript superscript hr print bold italic underline strikethrough removeformat unlink".split(" "),function(a,d){c[d]&&b.afterCreate(function(){Oa(this.edit.doc,c[d],function(){b.cmd.selection();b.clickToolbar(d)})});b.clickToolbar(d,function(){b.focus().exec(d,
null)})});b.afterCreate(function(){function c(){f.range.moveToBookmark(k);f.select();aa&&(a("div."+n,l).each(function(){a(this).after("\x3cbr /\x3e").remove(!0)}),a("span.Apple-style-span",l).remove(!0),a("span.Apple-tab-span",l).remove(!0),a("span[style]",l).each(function(){"nowrap"==a(this).css("white-space")&&a(this).remove(!0)}),a("meta",l).remove());var d=l[0].innerHTML;l.remove();""!==d&&(aa&&(d=d.replace(/(<br>)\1/ig,"$1")),2===b.pasteType&&(d=d.replace(/(<(?:p|p\s[^>]*)>) *(<\/p>)/ig,""),
/schemas-microsoft-com|worddocument|mso-\w+/i.test(d)?d=sb(d,b.filterMode?b.htmlTags:a.options.htmlTags):(d=X(d,b.filterMode?b.htmlTags:null),d=b.beforeSetHtml(d))),1===b.pasteType&&(d=d.replace(/&nbsp;/ig," \x26nbsp;"),d=d.replace(/\n\s*\n/g,"\n"),d=d.replace(/<br[^>]*>/ig,"\n"),d=d.replace(/<\/p><p[^>]*>/ig,"\n"),d=d.replace(/<[^>]+>/g,""),d=d.replace(/ {2}/g," \x26nbsp;"),"p"==b.newlineTag?/\n/.test(d)&&(d=d.replace(/^/,"\x3cp\x3e").replace(/$/,"\x3cbr /\x3e\x3c/p\x3e").replace(/\n/g,"\x3cbr /\x3e\x3c/p\x3e\x3cp\x3e")):
d=d.replace(/\n/g,"\x3cbr /\x3e$\x26")),b.insertHtml(d,!0))}var d=b.edit.doc,f,k,l,n="__kindeditor_paste__",s=!1;a(d.body).bind("paste",function(r){if(0===b.pasteType)r.stop();else if(!s){s=!0;a("div."+n,d).remove();f=b.cmd.selection();k=f.range.createBookmark();l=a('\x3cdiv class\x3d"'+n+'"\x3e\x3c/div\x3e',d).css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",left:"-1981px",top:a(k.start).pos().y+"px","white-space":"nowrap"});a(d.body).append(l);if(q){var t=f.range.get(!0);t.moveToElementText(l[0]);
t.select();t.execCommand("paste");r.preventDefault()}else f.range.selectNodeContents(l[0]),f.select();setTimeout(function(){c();s=!1},0)}})});b.beforeGetHtml(function(a){q&&8>=C&&(a=a.replace(/<div\s+[^>]*data-ke-input-tag="([^"]*)"[^>]*>([\s\S]*?)<\/div>/ig,function(a,b){return unescape(b)}),a=a.replace(/(<input)((?:\s+[^>]*)?>)/ig,function(a,b,c){return/\s+type="[^"]+"/i.test(a)?a:b+' type\x3d"text"'+c}));return a.replace(/(<(?:noscript|noscript\s[^>]*)>)([\s\S]*?)(<\/noscript>)/ig,function(a,b,
c,d){return b+ja(c).replace(/\s+/g," ")+d}).replace(/<img[^>]*class="?ke-(flash|rm|media)"?[^>]*>/ig,function(a){a=M(a);var b=fa(a.style||""),c=ub(a["data-ke-tag"]),d=l(b.width,""),b=l(b.height,"");/px/i.test(d)&&(d=w(d));/px/i.test(b)&&(b=w(b));c.width=l(a.width,d);c.height=l(a.height,b);return Qa(c)}).replace(/<img[^>]*class="?ke-anchor"?[^>]*>/ig,function(a){a=M(a);return'\x3ca name\x3d"'+unescape(a["data-ke-name"])+'"\x3e\x3c/a\x3e'}).replace(/<div\s+[^>]*data-ke-script-attr="([^"]*)"[^>]*>([\s\S]*?)<\/div>/ig,
function(a,b,c){return"\x3cscript"+unescape(b)+"\x3e"+unescape(c)+"\x3c/script\x3e"}).replace(/<div\s+[^>]*data-ke-noscript-attr="([^"]*)"[^>]*>([\s\S]*?)<\/div>/ig,function(a,b,c){return"\x3cnoscript"+unescape(b)+"\x3e"+unescape(c)+"\x3c/noscript\x3e"}).replace(/(<[^>]*)data-ke-src="([^"]*)"([^>]*>)/ig,function(a,b,c,d){a=a.replace(/(\s+(?:href|src)=")[^"]*(")/i,function(a,b,d){return b+ja(c)+d});return a=a.replace(/\s+data-ke-src="[^"]*"/i,"")}).replace(/(<[^>]+\s)data-ke-(on\w+="[^"]*"[^>]*>)/ig,
function(a,b,c){return b+c})});b.beforeSetHtml(function(a){q&&8>=C&&(a=a.replace(/<input[^>]*>|<(select|button)[^>]*>[\s\S]*?<\/\1>/ig,function(a){var b=M(a);return"none"==fa(b.style||"").display?'\x3cdiv class\x3d"ke-display-none" data-ke-input-tag\x3d"'+escape(a)+'"\x3e\x3c/div\x3e':a}));return a.replace(/<embed[^>]*type="([^"]+)"[^>]*>(?:<\/embe>d)?/ig,function(a){a=M(a);a.src=l(a.src,"");a.width=l(a.width,0);a.height=l(a.height,0);return vb(b.themesPath+"common/blank.gif",a)}).replace(/<a[^>]*name="([^"]+)"[^>]*>(?:<\/a>)?/ig,
function(a){var c=M(a);return void 0!==c.href?a:'\x3cimg class\x3d"ke-anchor" src\x3d"'+b.themesPath+'common/anchor.gif" data-ke-name\x3d"'+escape(c.name)+'" /\x3e'}).replace(/<script([^>]*)>([\s\S]*?)<\/script>/ig,function(a,b,c){return'\x3cdiv class\x3d"ke-script" data-ke-script-attr\x3d"'+escape(b)+'"\x3e'+escape(c)+"\x3c/div\x3e"}).replace(/<noscript([^>]*)>([\s\S]*?)<\/noscript>/ig,function(a,b,c){return'\x3cdiv class\x3d"ke-noscript" data-ke-noscript-attr\x3d"'+escape(b)+'"\x3e'+escape(c)+"\x3c/div\x3e"}).replace(/(<[^>]*)(href|src)="([^"]*)"([^>]*>)/ig,
function(a,b,c,d,e){return a.match(/\sdata-ke-src="[^"]*"/i)?a:a=b+c+'\x3d"'+d+'" data-ke-src\x3d"'+E(d)+'"'+e}).replace(/(<[^>]+\s)(on\w+="[^"]*"[^>]*>)/ig,function(a,b,c){return b+"data-ke-"+c}).replace(/<table[^>]*\s+border="0"[^>]*>/ig,function(a){return 0<=a.indexOf("ke-zeroborder")?a:cc(a,"ke-zeroborder")})})})}})(window);